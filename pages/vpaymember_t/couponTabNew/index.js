require("../runtime"),require("../vendors"),(wx["webpackJsonp/pages/vpaymember_t/"]=wx["webpackJsonp/pages/vpaymember_t/"]||[]).push([[5],{107:function(e,o,t){"use strict";t(5);var n=t(1),a=t(21),c=t.n(a),i=t(0);o.a=function VCouponComp(e){return 5==e.exchangeType?Object(i.jsxs)(n.j,{className:1==e.state?c.a["coupon-box"]:c.a["coupon-box-not"],children:[Object(i.jsxs)(n.j,{className:c.a["coupon-img"],style:{background:"url(https://storage.360buyimg.com/wximg/member/quan2.png) no-repeat",backgroundSize:"100% 100%"},children:[e.cornerTag&&Object(i.jsx)(n.j,{className:c.a["coupon-tag"],children:Object(i.jsx)(n.j,{className:c.a["coupon-tag-txt"],children:e.cornerTag})}),e&&e.quota&&Object(i.jsxs)(n.j,{className:c.a["quota-box"],children:[e.quota,Object(i.jsx)(n.j,{className:c.a["quota-box-quit"],children:"元"})]})]}),Object(i.jsxs)(n.j,{className:c.a["coupon-content"],children:[Object(i.jsx)(n.j,{className:c.a["coupon-name"],children:e.name}),Object(i.jsx)(n.j,{className:c.a["coupon-cill"],children:e.limitRule})]}),1==e.state?Object(i.jsxs)(n.j,{className:c.a["coupon-button-box"],children:[Object(i.jsx)(n.j,{className:c.a["coupon-button"],onClick:function onClick(){return e.gotoUse(e)},children:"立即使用"}),Object(i.jsx)(n.j,{className:c.a["coupon-cancel"],onClick:function onClick(){return e.cancelUse(e)},children:"撤销兑换"})]}):Object(i.jsxs)(n.j,{className:c.a["coupon-change-box"],children:[Object(i.jsx)(n.c,{className:c.a["coupon-bling"],src:"https://storage.360buyimg.com/wximg/member/allance-re.png"}),Object(i.jsxs)(n.j,{className:c.a["coupon-change"],onClick:function onClick(){return e.gotoChange(e)},children:[e.cost,"津贴兑换"]})]})]}):6==e.exchangeType?Object(i.jsxs)(n.j,{className:1==e.state?c.a["coupon-box"]:c.a["coupon-box-not"],children:[Object(i.jsx)(n.j,{className:[c.a["coupon-img"],c.a["red-img"]].join(" "),style:{background:"url(https://storage.360buyimg.com/wximg/member/hong2.png) no-repeat",backgroundSize:"100% 100%"},children:e&&e.quota&&Object(i.jsxs)(n.j,{className:c.a["red-box"],children:[Object(i.jsxs)(n.j,{className:c.a["red-box-quota"],children:[e.quota,Object(i.jsx)(n.j,{className:c.a["red-box-quit"],children:"元"})]}),Object(i.jsx)(n.j,{className:c.a["red-box-txt"],children:e.quotaText})]})}),Object(i.jsxs)(n.j,{className:c.a["coupon-content"],children:[Object(i.jsx)(n.j,{className:c.a["coupon-name"],children:e.name}),Object(i.jsx)(n.j,{className:c.a["coupon-cill"],children:e.limitRule})]}),1==e.state?Object(i.jsxs)(n.j,{className:c.a["coupon-button-box"],children:[Object(i.jsx)(n.j,{className:c.a["coupon-button"],onClick:function onClick(){return e.gotoUse(e)},children:"立即使用"}),Object(i.jsx)(n.j,{className:c.a["coupon-cancel"],onClick:function onClick(){return e.cancelUse(e)},children:"撤销兑换"})]}):Object(i.jsxs)(n.j,{className:c.a["coupon-change-box"],children:[Object(i.jsx)(n.c,{className:c.a["coupon-bling"],src:"https://storage.360buyimg.com/wximg/member/allance-re.png"}),Object(i.jsxs)(n.j,{className:c.a["coupon-change"],onClick:function onClick(){return e.gotoChange(e)},children:[e.cost,"津贴兑换"]})]})]}):null}},108:function(e,o,t){"use strict";var n=t(6),a=t(7),c=t(15),i=t(8),s=t(9),l=t(10),u=t(3),r=t.n(u),p=t(5),d=t(16),_=t(14),m=t(1),h=t(28),b=t.n(h),x=t(0),j=function(e){Object(i.a)(PoupEnvelopes,e);var o=Object(s.a)(PoupEnvelopes);function PoupEnvelopes(e){var t;return Object(n.a)(this,PoupEnvelopes),t=o.call(this,e),Object(l.a)(Object(c.a)(t),"confirmExchange",(function(e){e.preventDefault(),e.stopPropagation();var o=t.props.exchangeData,n={exchangeId:o.id,grabChannel:o.grabChannel};Object(d.m)(n).then((function(e){t.closeExchangePop(),0==e.code?(r.a.showToast({title:e.msg||"撤销成功",icon:"none",duration:1500}),Object(_.a)({page_name:"VIP_page_name",create_time:new Date,click_id:"clickButton",click_par:{type:"dismiss",btnName:"撤销兑换"}}),t.refreshPage()):r.a.showToast({title:e.msg,icon:"none",duration:1500})})).catch((function(e){r.a.showToast({title:e.msg,icon:"none",duration:1500})}))})),Object(l.a)(Object(c.a)(t),"closeBtn",(function(){t.props.closeExchangePop()})),t}return Object(a.a)(PoupEnvelopes,[{key:"componentDidMount",value:function componentDidMount(){Object(_.a)({page_name:"VIP_page_name",create_time:new Date,click_id:"showLayer",click_par:{type:"dismiss"}})}},{key:"render",value:function render(){var e=this.props.exchangeData||{},o=e.sourcePackage,t=e.targetPackage,n=e.title,a=e.subTitle,c=e.storeLogo,i=e.exchangeFlag;return console.log(i),Object(x.jsxs)(m.j,{onClick:this.closeBtn.bind(this),className:b.a["alert-box"],children:[Object(x.jsxs)(m.j,{className:b.a.alert_box_wrap,children:[Object(x.jsx)(m.j,{className:b.a.title,children:n}),Object(x.jsx)(m.j,{className:b.a.subTitle,children:a}),Object(x.jsxs)(m.j,{className:b.a.couponBox,children:[6==i?Object(x.jsxs)(m.j,{className:b.a.rtRedBox,children:[Object(x.jsxs)(m.j,{className:b.a.rtRedBoxNum,children:[o.amount,Object(x.jsx)(m.i,{className:b.a.rtRedBoxUnit,children:"元"})]}),Object(x.jsx)(m.j,{className:b.a.rtRedBoxTxt,children:"V+会员红包"})]}):Object(x.jsxs)(m.j,{className:b.a.rtCouponBox,children:[Object(x.jsx)(m.j,{className:b.a.rtCouponLogoBox,children:Object(x.jsx)(m.c,{className:b.a.rtCouponLogo,src:c||"https://storage.360buyimg.com/wximg/common/logo.jpg"})}),Object(x.jsxs)(m.j,{className:b.a.leftCouponMon,children:[o.amount,Object(x.jsx)(m.i,{className:b.a.leftCouponUnit,children:"元"})]}),Object(x.jsx)(m.j,{className:b.a.leftCouponLimit,children:o.limitRule||o.couponTypeDesc||"满29元可用"})]}),Object(x.jsx)(m.j,{className:b.a.exchangeIMg}),Object(x.jsxs)(m.j,{className:[b.a.leftCouponBox,4==i||6==i?"":b.a.marTop2].join(" "),children:[Object(x.jsx)(m.j,{className:b.a.leftCouponAllance,children:Object(x.jsx)(m.c,{className:b.a.leftCouponAllanceStar,src:"https://storage.360buyimg.com/wximg/member/allance-re.png"})}),Object(x.jsxs)(m.j,{className:b.a.leftCouponMon,children:[t.amount,"元津贴"]})]})]}),Object(x.jsxs)(m.j,{className:b.a["alert-box-bottom"],children:[Object(x.jsx)(m.j,{className:b.a["cancel-box-btn"],onClick:this.closeBtn.bind(this),children:"取消"}),Object(x.jsx)(m.j,{className:b.a["alert-box-btn"],onClick:this.confirmExchange.bind(this),children:"确认"})]})]}),Object(x.jsx)(m.j,{className:b.a.close,onClick:this.closeBtn.bind(this)})]})}},{key:"closeExchangePop",value:function closeExchangePop(){this.props.closeExchangePop()}},{key:"refreshPage",value:function refreshPage(){this.props.refreshPage()}}]),PoupEnvelopes}(p.default.Component);o.a=j},16:function(e,o,t){"use strict";t.d(o,"j",(function(){return a})),t.d(o,"C",(function(){return c})),t.d(o,"l",(function(){return i})),t.d(o,"d",(function(){return s})),t.d(o,"f",(function(){return l})),t.d(o,"e",(function(){return u})),t.d(o,"m",(function(){return r})),t.d(o,"c",(function(){return p})),t.d(o,"g",(function(){return d})),t.d(o,"h",(function(){return _})),t.d(o,"q",(function(){return m})),t.d(o,"L",(function(){return h})),t.d(o,"i",(function(){return b})),t.d(o,"G",(function(){return x})),t.d(o,"K",(function(){return j})),t.d(o,"I",(function(){return g})),t.d(o,"F",(function(){return f})),t.d(o,"p",(function(){return v})),t.d(o,"b",(function(){return O})),t.d(o,"w",(function(){return y})),t.d(o,"k",(function(){return C})),t.d(o,"A",(function(){return N})),t.d(o,"B",(function(){return P})),t.d(o,"J",(function(){return k})),t.d(o,"y",(function(){return E})),t.d(o,"a",(function(){return I})),t.d(o,"z",(function(){return T})),t.d(o,"n",(function(){return w})),t.d(o,"u",(function(){return B})),t.d(o,"v",(function(){return S})),t.d(o,"x",(function(){return L})),t.d(o,"E",(function(){return D})),t.d(o,"t",(function(){return R})),t.d(o,"r",(function(){return M})),t.d(o,"s",(function(){return q})),t.d(o,"M",(function(){return U})),t.d(o,"D",(function(){return J})),t.d(o,"H",(function(){return F})),t.d(o,"o",(function(){return V}));var n=t(2),a=function api_nearbystore_list(e){return Object(n.a)({functionId:"vip/store/nearList",body:e})},c=function get_purchasePage_info(e){return Object(n.a)({functionId:"pay/vip/purchasePage",method:"POST",body:JSON.stringify(e)})},i=function api_plus_vipPurchase(e){return Object(n.a)({functionId:"pay/vip/purchase",body:e})},s=function api_buy_record(e){return Object(n.a)({functionId:"pay/vip/record",body:e||{}})},l=function api_convertCouponCheck(e){return Object(n.a)({functionId:"vip/convertCouponCheck",method:"POST",body:JSON.stringify(e)})},u=function api_convertCoupon(e){return Object(n.a)({functionId:"vip/convertCoupon",method:"POST",body:JSON.stringify(e)})},r=function api_undoExchange(e){return Object(n.a)({functionId:"vip/exchange/undo",method:"POST",body:JSON.stringify(e)})},p=function api_allowanceList(e){return Object(n.a)({functionId:"pay/vip/allowance/detail",body:e||{}})},d=function api_exchangeconCheck(e){return Object(n.a)({functionId:"pay/vip/exchange/check",body:e||{}})},_=function api_exchangeconFirm(e){return Object(n.a)({functionId:"pay/vip/exchange/confirm",body:e||{}})},m=function discountListCont(e){return Object(n.a)({functionId:"pay/vip/red/packet/discount",body:e||{}})},h=function tabContentFun(e){return Object(n.a)({functionId:"pay/vip/red/packet/tab",body:e||{}})},b=function api_getCouponData(e){return Object(n.a)({functionId:"vip/exchange/queryPageList",body:e||{}})},x=function protocolFun(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n.a)({functionId:"pay/vip/protocol",body:e})},j=function storeInfoFun(e){return Object(n.a)({functionId:"pay/vip/store",method:"POST",body:JSON.stringify(e)})},g=function queryPayStatusFun(e){return console.log(JSON.stringify(e),"------参数"),Object(n.a)({functionId:"tx/core/queryPayStatus",body:JSON.stringify(e)})},f=function payModesFun(e){return Object(n.a)({functionId:"pay/cashier/pay-modes",method:"POST",body:JSON.stringify(e)})},v=function directPayFun(e){return Object(n.a)({functionId:"pay/cashier/direct-pay",method:"POST",body:JSON.stringify(e),isNeedDealError:1})},O=function abStrategyFun(){return Object(n.a)({functionId:"pay/cashier/ab-strategy",method:"POST"})},y=function getPayInfoFun(e){return Object(n.a)({functionId:"pay/cashier/get-pay-info",method:"POST",body:e})},C=function api_plus_main_new(e){return Object(n.a)({functionId:"pay/vip/main-page",method:"POST",body:e})},N=function getVenuePageFun(e){return Object(n.a)({functionId:"pay/vip/venuePage",method:"GET",body:JSON.stringify(e)})},P=function getVenueReceiveFun(e){return Object(n.a)({functionId:"pay/vip/venueReceive",method:"POST",body:JSON.stringify(e)})},k=function showMoreFun(e){return Object(n.a)({functionId:"pay/vip/showMore",method:"GET",body:JSON.stringify(e)})},E=function getRights(e){return Object(n.a)({functionId:"vip/benefit/all",method:"GET",body:JSON.stringify(e)})},I=function abProductList(e){return Object(n.a)({functionId:"vip/ab/product-list",method:"GET",body:JSON.stringify(e)})},T=function getSharePic(e){return Object(n.a)({functionId:"vip/share/image",method:"GET",body:JSON.stringify(e)})},w=function api_vip_goods_list(e){return Object(n.a)({functionId:"vip/sku/vipPrice",method:"POST",body:e})},B=function getNearBigCouponList(e){return Object(n.a)({functionId:"vip/member/price/nearList",method:"POST",body:JSON.stringify(e)})},S=function getNearBigCouponListMore(e){return Object(n.a)({functionId:"vip/member/price/loadMore",method:"POST",body:JSON.stringify(e)})},L=function getQueryStatusForV(e){return Object(n.a)({functionId:"vip/contract/queryStatusForV",method:"GET",body:JSON.stringify(e)})},D=function noticeResult(e){return Object(n.a)({functionId:"vip/contract/noticeResult",method:"GET",body:JSON.stringify(e)})},R=function getContractInfoPage(e){return Object(n.a)({functionId:"vip/contract/infoPage",method:"GET",body:JSON.stringify(e)})},M=function getContractCancel(e){return Object(n.a)({functionId:"vip/contract/cancel",method:"GET",body:JSON.stringify(e)})},q=function getContractHistoryState(e){return Object(n.a)({functionId:"vip/contract/historyState",method:"GET",body:JSON.stringify(e)})},U=function vipMarket(e){return Object(n.a)({functionId:"vip/market/orderGuide",method:"GET",body:JSON.stringify(e),isNeedDealError:1})},J=function layerIndex(e){return Object(n.a)({functionId:"vip/layer/index",method:"GET",body:JSON.stringify(e)})},F=function queryPageList(e){return Object(n.a)({functionId:"vip/exchange/queryPageList",method:"GET",body:JSON.stringify(e)})},V=function dealButton(e){return Object(n.a)({functionId:"pay/vip/dealButton",method:"POST",body:JSON.stringify(e)})}},20:function(e,o,t){"use strict";(function(e){t.d(o,"b",(function(){return i})),t.d(o,"c",(function(){return s})),t.d(o,"a",(function(){return l}));var n=t(4),a=t(3),c=t.n(a),i=function navigateTo(e){var o=e.url;return(o.indexOf("testpdjm.jd.com")>-1||o.indexOf("prepdjm.jd.com")>-1||o.indexOf("daojia.jd.com")>-1||o.indexOf("prepdj-three.jddj.com")>-1)&&(o="/pages/"+o.split("/pages/")[1]),c.a.navigateTo({url:o})},s=function postMsgUpdateV(){n.c&&_isCompatible(String(n.a),String("8.6.0"))>=0&&(n.d?n.h&&e.webkit.messageHandlers.MobileNavi.postMessage({method:"updateVPlusPage",callBackName:null,callBackId:null}):n.b&&e.djJava.closeWebview&&e.djJava.updateVPlusPage())},l=function closeWebView(){n.c&&_isCompatible(String(n.a),String("8.6.0"))>=0&&(n.d?n.h&&e.webkit.messageHandlers.MobileNavi.postMessage({method:"closeWebview",callBackName:null,callBackId:null}):n.b&&e.djJava.closeWebview&&e.djJava.closeWebview())};function _isCompatible(e,o){e=e.split("."),o=o.split(".");for(var t=Math.max(e.length,o.length);e.length<t;)e.push("0");for(;o.length<t;)o.push("0");for(var n=0;n<t;n++){var a=parseInt(e[n]),c=parseInt(o[n]);if(a>c)return 1;if(a<c)return-1}return 0}}).call(this,t(11).window)},204:function(e,o,t){"use strict";t.r(o);t(68);var n=t(13),a=t(11),c=t(42),i=t(5);a.container.get(a.SERVICE_IDENTIFIER.Hooks).initNativeApiImpls=[n.c.initNativeApi];var s={pages:["pages/index/index"],subPackages:[{root:"pages/vipChannel-t/",pages:["index"],independent:!0},{root:"pages/merchant-t/",pages:["agreement/index"],independent:!0},{root:"pages/vpaymember_t/",pages:["home/index","memberGoods/index","packageSelection/index","rightsInstruction/index","memberDay/index","couponTab/index","couponTabNew/index","exchangePage/index","instructions/index","envelopesRecord/index","bountyList/index","discountList/index","manageRenew/index","payResult/index","toVPlusCenterPage/index"],independent:!0},{root:"pages/test-t/",pages:["hy/index"]}],permission:{"scope.userLocation":{desc:"你的位置信息将用获取最近的门店信息"}},plugins:{loginPlugin:{version:"1.5.1",provider:"wxefe655223916819e"},"live-player-plugin":{version:"1.3.5",provider:"wx2b03c6e691cd7370"}},window:{backgroundTextStyle:"light",navigationBarBackgroundColor:"#fff",navigationBarTitleText:"WeChat",navigationBarTextStyle:"black"}};a.window.__taroAppConfig=s;class App extends i.Component{render(){return this.props.children}}Object(c.a)(App,i,i.default,s);var l=t(225).default;Page(Object(a.createPageConfig)(l,"pages/vpaymember_t/couponTabNew/index",{},{navigationBarBackgroundColor:"#fff",navigationBarTextStyle:"black",enablePullDownRefresh:!1,onReachBottomDistance:20}||{}))},21:function(e,o,t){e.exports={"coupon-box":"index-module__coupon-box___2q0Rd","coupon-box-not":"index-module__coupon-box-not___2K2om","coupon-img":"index-module__coupon-img___1GMgj","coupon-tag":"index-module__coupon-tag___3bBO5","coupon-tag-txt":"index-module__coupon-tag-txt___UGhGK","quota-box":"index-module__quota-box___3a_dQ","quota-box-quit":"index-module__quota-box-quit___Dj8TU","red-box":"index-module__red-box___22hAR","red-box-quota":"index-module__red-box-quota___2KQsQ","red-box-quit":"index-module__red-box-quit___3HE0i","red-box-txt":"index-module__red-box-txt___35lMb","red-img":"index-module__red-img___1K94Y","coupon-content":"index-module__coupon-content___31SpK","coupon-name":"index-module__coupon-name___1GIAM","coupon-cill":"index-module__coupon-cill___1jqCK","coupon-button-box":"index-module__coupon-button-box___1XAOa","coupon-button":"index-module__coupon-button___2fJq-","coupon-cancel":"index-module__coupon-cancel___1RhPn","coupon-change-box":"index-module__coupon-change-box___2PFHe","coupon-bling":"index-module__coupon-bling___3jH8R","coupon-change":"index-module__coupon-change___3Wo8d"}},225:function(e,o,t){"use strict";t.r(o);var n=t(62),a=t(30),c=t(157),i=t(22),s=t(39),l=t(6),u=t(7),r=t(8),p=t(9),d=t(3),_=t.n(d),m=t(1),h=t(14),b=t(16),x=t(50),j=t(41),g=t.n(j),f=t(54),v=t(69),O=t(35),y=t(57),C=t(5),N=t(82),P=t.n(N),k=t(0),E=function(e){Object(r.a)(PopEx,e);var o=Object(p.a)(PopEx);function PopEx(e){return Object(l.a)(this,PopEx),o.call(this,e)}return Object(u.a)(PopEx,[{key:"render",value:function render(){var e;return e=null,this.props.isNeedCloseIcon&&(e=Object(k.jsx)(m.j,{className:P.a.cancel,onClick:this.onClosePop.bind(this),children:Object(k.jsx)(m.j,{style:"margin-top: 15px",children:this.props.quit})})),Object(k.jsx)(m.j,{className:"".concat(P.a.wrap," ").concat(this.props.isShow?"":P.a.hide),children:Object(k.jsx)(m.j,{className:P.a.case,children:Object(k.jsxs)(m.j,{className:P.a.content,children:[Object(k.jsxs)(m.j,{className:P.a.main,children:[Object(k.jsx)(m.j,{className:P.a.titlecss,children:this.props.title}),Object(k.jsx)(m.j,{className:P.a.textcss,children:this.props.text})]}),Object(k.jsxs)(m.j,{className:P.a.btnarea,children:[e,Object(k.jsx)(m.j,{className:P.a.confirm,onClick:this.onClickPop.bind(this),children:Object(k.jsx)(m.j,{style:"margin-top: 15px",children:this.props.ok})})]})]})})})}},{key:"onClosePop",value:function onClosePop(e){e.stopPropagation(),this.props.onPopEvent({type:"close"})}},{key:"onClickPop",value:function onClickPop(e){e.stopPropagation(),this.props.onPopEvent({type:"content",params:{}})}}]),PopEx}(C.Component),I=t(20),T=t(90),w=t(108),B=t(33),S=t(107),L=function(e){Object(r.a)(couponTab,e);var o,t=Object(p.a)(couponTab);function couponTab(e){var o;return Object(l.a)(this,couponTab),(o=t.call(this,e)).state={activeIndex:1,couponListIndex:1,couponList:[],pageNum:1,allowanceNum:0,exchangeDesc:"",isLoading:!1,showPoup:!1,showCancelPoup:!1,isOpen:!1,address:{},exchangeData:{id:""},needCloseBtn:!0,showOverTime:!1,title:"",text:"",couponItem:{},consumeCode:"",shouldGetShopFlag:!1,isLoginFlag:!1},o}return Object(u.a)(couponTab,[{key:"componentDidMount",value:(o=Object(s.a)(Object(i.a)().mark((function _callee(){var e;return Object(i.a)().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return e=!1,o.prev=1,o.next=4,Object(B.b)();case 4:e=o.sent,o.next=10;break;case 7:o.prev=7,o.t0=o.catch(1),e=!1;case 10:this.getLocation(),_.a.setNavigationBarTitle({title:"会员津贴"}),this.setState({isLoginFlag:e}),Object(h.b)({page_name:"VIP_page_name",page_par:{click_id:"VIPrednewpage"}});case 14:case"end":return o.stop()}}),_callee,this,[[1,7]])}))),function componentDidMount(){return o.apply(this,arguments)})},{key:"onReachBottom",value:function onReachBottom(){console.log("走onReachBottom",this.state.shouldGetShopFlag),this.state.shouldGetShopFlag&&(console.log("加载更多"),this.getCouponData())}},{key:"render",value:function render(){var e,o,t=this.state,n=t.isLoading,a=t.isOpen,i=t.title,s=t.text,l=t.needCloseBtn,u=t.showPoup,r=t.showOverTime,p=t.showCancelPoup,_=(t.couponItem,t.consumeCode),h=t.exchangeData;return Object(c.a)((null===(e=Object(d.getCurrentInstance)())||void 0===e||null===(o=e.router)||void 0===o?void 0:o.params)||{}),Object(k.jsxs)(m.j,{className:g.a.couponTabPage,children:[n?Object(k.jsx)(x.a,{}):this.renderAllowance(),Object(k.jsx)(E,{isNeedCloseIcon:l,isShow:a,text:s,title:i,onPopEvent:this.popBtn.bind(this),ok:"确认兑换",quit:"我再想想"}),u&&Object(k.jsx)(T.a,{type:"allowance",exchangeData:h,closeExchangePop:this.closeExchangePop.bind(this),refreshPage:this.refreshPage.bind(this)}),p&&Object(k.jsx)(w.a,{exchangeData:h,consumeCode:_,closeExchangePop:this.closeCancelUse.bind(this),refreshPage:this.refreshPage.bind(this)}),Object(k.jsx)(y.a,{isShow:r,defineSelf:!0,isNeedCloseIcon:!0,onPopEvent:this.onPopEvent.bind(this),onClickPop:this.onClickPop.bind(this),children:Object(k.jsxs)(m.j,{className:g.a.popSty,children:[Object(k.jsx)(m.j,{children:"当前会员已过期，不能使用津贴；若续费成功，立即恢复津贴，31天未续费则津贴失效并清零。"}),Object(k.jsxs)(m.j,{className:g.a.btnBox,children:[Object(k.jsx)(m.j,{className:g.a.btn_know,onClick:this.onPopEvent.bind(this),children:"我知道了"}),Object(k.jsx)(m.j,{className:g.a.btn_rent,onClick:this.toRent.bind(this),children:"立即续费"})]})]})})]})}},{key:"renderCoupon",value:function renderCoupon(){var e=this,o=this.state,t=o.activeIndex,n=o.couponList;return n&&n.length?n.map((function(o,n){return 5===o.exchangeType||6===o.exchangeType?Object(k.jsx)(m.j,{className:g.a.v_coupon_box,children:Object(k.jsx)(S.a,Object(a.a)(Object(a.a)(Object(a.a)({},o),o.targetDesc),{},{gotoUse:e.gotoUse.bind(e),cancelUse:e.cancelUse.bind(e),gotoChange:e.gotoChange.bind(e)}))},"indexV".concat(n)):Object(k.jsxs)(m.j,{className:[g.a.couponBox].join(" "),children:[3==t?Object(k.jsx)(m.j,{className:g.a.couponBoxMax}):"",3==t?o.sendDate?Object(k.jsxs)(m.j,{className:g.a.s_time,children:[o.sendDate,"发放"]}):null:Object(k.jsx)(m.j,{className:g.a.label,children:o.showText||"可叠加"}),Object(k.jsxs)(m.j,{className:g.a.MonBox,children:[Object(k.jsx)(m.i,{className:g.a.MonNum,children:o.discountValue||o.quota||o.amount}),Object(k.jsx)(m.i,{className:g.a.MonUnit,children:"元"}),Object(k.jsx)(m.j,{className:g.a.description,children:o.limitRule||o.discountSubtitle})]}),Object(k.jsxs)(m.j,{className:g.a.conCenterBox,children:[Object(k.jsx)(m.j,{className:g.a.couponName,children:o.title||o.discountTitle||o.showName}),Object(k.jsxs)(m.j,{className:g.a.couponLimit,children:[" ","需".concat(o.expendAllowance,"个津贴")]}),Object(k.jsx)(m.j,{className:g.a.couponTime,children:o.expiryDateText||o.availableDate||""})]}),Object(k.jsx)(m.j,{className:g.a.conRtBox,children:Object(k.jsx)(m.j,{className:g.a.useBtn,onClick:e.toExchange.bind(e,o),children:0==o.exchangeState?"立即兑换":"去使用"})})]},"index".concat(n))})):this.renderEmpty()}},{key:"renderAllowance",value:function renderAllowance(){var e=this.state,o=e.allowanceNum,t=e.exchangeDesc;return Object(k.jsxs)(m.j,{className:g.a.allowanceBox,children:[Object(k.jsxs)(m.j,{className:g.a.allowanceTop,children:[Object(k.jsxs)(m.j,{className:g.a.topLt,children:[Object(k.jsxs)(m.j,{className:g.a.title,children:["会员津贴",Object(k.jsx)(m.c,{className:g.a.titleI,src:"https://storage.360buyimg.com/wximg/member/allance-re.png"})]}),Object(k.jsx)(m.j,{className:g.a.subT,children:t})]}),Object(k.jsxs)(m.j,{className:g.a.topRt,onClick:this.todetail.bind(this),children:[Object(k.jsx)(m.i,{className:g.a.topRt_num,children:o}),Object(k.jsxs)(m.i,{className:g.a.topRt_unit,children:["元"," > "]})]})]}),this.renderCoupon()]})}},{key:"renderEmpty",value:function renderEmpty(){return Object(k.jsxs)(m.j,{className:g.a.listEmpty,children:[Object(k.jsx)(m.c,{src:"https://storage.360buyimg.com/wximg/defaultPage/icon_nodata.png",className:g.a.emptyImg}),Object(k.jsx)(m.j,{className:g.a.emptyTxt,children:"空空如也"})]})}},{key:"gotoUse",value:function gotoUse(e){console.log("gotoUse item :>> ",e),this.setState({couponItem:e}),Object(h.a)({page_name:"VIP_page_name",create_time:new Date,click_id:"clickCoupon",click_par:{couponId:e.couponId,btnName:"立即使用"}}),Object(v.a)({couponId:e.couponId,code:e.activityCode})}},{key:"cancelUse",value:function cancelUse(e){console.log("cancelUse item :>> ",e),Object(h.a)({page_name:"VIP_page_name",create_time:new Date,click_id:"clickCoupon",click_par:{couponId:e.couponId,btnName:"撤销兑换"}}),this.cancelCouponCheck(e)}},{key:"closeCancelUse",value:function closeCancelUse(){this.setState({showCancelPoup:!1})}},{key:"gotoChange",value:function gotoChange(e){console.log("gotoChange item :>> ",e),Object(h.a)({page_name:"VIP_page_name",create_time:new Date,click_id:"clickCoupon",click_par:{couponId:e.couponId,btnName:"津贴兑换"}}),this.convertCouponCheck(e)}},{key:"closeExchangePop",value:function closeExchangePop(){this.setState({showPoup:!1})}},{key:"cancelCouponCheck",value:function cancelCouponCheck(e){var o=this,t=(this.state.address||{}).cityId;console.log("item---",e);var n={cityId:t,pin:Object(O.a)("PDJ_H5_PIN")||Object(O.a)("pin")||Object(O.a)("PDJ_H5_JDPIN"),activityCode:e.activityCode,serviceVersion:2,consumeCode:"",grabChannel:"vip_allowance_page",platform:"H5",requestor:"vplus",exchangeId:e.id,exchangeFlag:7};e.params&&e.params.storeId&&(n.storeId=e.params.storeId),Object(b.f)(n).then((function(t){if("0"==t.code&&t.result.vip){var n=t&&t.result,a=n.sourcePackage,c=n.targetPackage,i=n.title,s=n.subTitle,l=n.storeLogo;o.setState({exchangeData:{title:i,subTitle:s,sourcePackage:a,targetPackage:c,storeLogo:l,id:e.id||"",grabChannel:"vip_allowance_page",exchangeFlag:e.exchangeType},consumeCode:a.activityCode,couponItem:e,showCancelPoup:!0})}else _.a.showToast({title:"您的会员已过期，无法撤销兑换～",icon:"none"})})).catch((function(e){_.a.showToast({title:e.msg||"网络开小差，请稍后重试",icon:"none",duration:1500})}))}},{key:"convertCouponCheck",value:function convertCouponCheck(e){var o=this,t=this.state.isLoginFlag,n=(this.state.address||{}).cityId;if(console.log("检查是否能发起兑换 item---",e),t){var a={cityId:n,pin:Object(O.a)("PDJ_H5_PIN")||Object(O.a)("pin")||Object(O.a)("PDJ_H5_JDPIN"),activityCode:e.activityCode,serviceVersion:2,consumeCode:"",grabChannel:"vip_allowance_page",platform:"H5",requestor:"vplus",exchangeId:e.id};e.params&&e.params.storeId&&(a.storeId=e.params.storeId),Object(b.f)(a).then((function(t){if("0"!=t.code||t.result.vip){if("0"==t.code&&t.result.vip){var n=t&&t.result,a=n.sourcePackage,c=n.targetPackage,i=n.title,s=n.subTitle,l=n.storeLogo,u=n.exchangeFlag;o.setState({showPoup:!0,couponItem:e,exchangeData:{title:i,subTitle:s,sourcePackage:a,targetPackage:c,storeLogo:l,id:e.id,exchangeFlag:u,buttonTitle:"确定兑换"},consumeCode:a.activityCode})}}else o.setState({showOverTime:!0})})).catch((function(e){_.a.showToast({title:e.msg||"网络开小差，请稍后重试",icon:"none",duration:1500})}))}else Object(B.a)()}},{key:"onClickPop",value:function onClickPop(){}},{key:"toRent",value:function toRent(){var e,o;this.setState({showOverTime:!1});var t=((null===(e=Object(d.getCurrentInstance)())||void 0===e||null===(o=e.router)||void 0===o?void 0:o.params)||{}).vipFlag,n=void 0===t?0:t;Object(I.b)({url:"/pages/vpaymember_t/packageSelection/index?vipFlag=".concat(n,"&h5=#newPay")})}},{key:"refreshPage",value:function refreshPage(){var e=this;setTimeout((function(){e.setState({pageNum:1,couponList:[]},(function(){e.getCurrentTypeData(2),e.getCouponData()}))}),1e3)}},{key:"onPopEvent",value:function onPopEvent(){this.setState({showOverTime:!1})}},{key:"todetail",value:function todetail(){Object(I.b)({url:"/pages/vpaymember_t/bountyList/index"})}},{key:"getLocation",value:function getLocation(){var e=this;Object(f.a)().then((function(o){console.log("getLocation---couponTab-------------------",o),o.cityId=o.cityId||o.areaCode||o.cityCode||"",o.cityName=o.city||o.cityName||"",e.setState({address:o||{}},(function(){e.getCurrentTypeData(2),e.getCouponData()}))})).catch((function(e){}))}},{key:"getCurrentTypeData",value:function getCurrentTypeData(e){var o=this,t=this.state.address,n={longitude:t.longitude||"",latitude:t.latitude||"",cityId:t.cityId||"",tabType:2,pageVersion:"V9"};Object(b.L)(n).then((function(e){Object(d.hideLoading)(),0==e.code?(o.setState({couponListIndex:2,allowanceNum:e.result.data.allowanceNum,exchangeDesc:e.result.exchangeDesc,isLoading:!1}),e.result.data.exchangeInfoList&&e.result.data.exchangeInfoList.length>0&&o.setState({couponList:e.result.data.exchangeInfoList})):o.setState({isLoading:!1})})).catch((function(e){o.setState({isLoading:!1}),Object(d.hideLoading)()}))}},{key:"getCouponData",value:function getCouponData(){var e=this,o={page:this.state.pageNum,size:10};Object(b.i)(o).then((function(o){if(Object(d.hideLoading)(),0==o.code){if(e.setState({isLoading:!1}),o.result.list&&o.result.list.length>0){var t=[].concat(Object(n.a)(e.state.couponList),Object(n.a)(o.result.list));e.setState({couponList:t,pageNum:e.state.pageNum+1}),o.result.list&&o.result.list.length>=10?e.setState({shouldGetShopFlag:!0}):e.setState({shouldGetShopFlag:!1})}}else e.setState({isLoading:!1})})).catch((function(o){e.setState({isLoading:!1}),Object(d.hideLoading)()}))}},{key:"toUse",value:function toUse(e){Object(v.a)({couponId:e.couponId,code:e.activityCode})}},{key:"popBtn",value:function popBtn(e){"close"==e.type&&this.setState({isOpen:!1}),"content"==e.type&&(this.setState({isOpen:!1}),this.confirmExchange())}},{key:"confirmExchange",value:function confirmExchange(){var e=this;console.log("this.state.exchangeData",this.state.exchangeData);var o=this.state.exchangeData,t=this.state.address||{},n=t.cityId,a=t.longitude,c=t.latitude;Object(b.h)({showName:o.showName||"",exchangeType:o.exchangeType||"",activityCode:o.activityCode||"",couponId:o.couponId||"",quota:o.quota||"",threshold:o.threshold||"",expendAllowance:o.expendAllowance||"",createPin:o.createPin||"",longitude:a,latitude:c,cityId:n,uuid:o.uuid}).then((function(o){0==o.code?(Object(d.showToast)({icon:"none",title:o.msg||"兑换成功"}),e.refreshPage()):Object(d.showToast)({icon:"none",title:o.msg||"兑换失败，请稍后重试"})})).catch((function(e){Object(d.showToast)({icon:"none",title:e.msg||"兑换失败，请稍后重试"})}))}},{key:"toExchange",value:function toExchange(e){var o,t,n=this,a=((null===(o=Object(d.getCurrentInstance)())||void 0===o||null===(t=o.router)||void 0===t?void 0:t.params)||{}).vipFlag;if(3==(void 0===a?0:a))this.setState({showOverTime:!0});else if(0==e.exchangeState){var c=this.state.address||{},i=c.cityId,s=c.longitude,l=c.latitude;Object(b.g)({showName:e.showName||"",exchangeType:e.exchangeType||"",activityCode:e.activityCode||"",couponId:e.couponId||"",quota:e.quota||"",threshold:e.threshold||"",expendAllowance:e.expendAllowance||"",createPin:e.createPin||"",longitude:s,latitude:l,cityId:i,uuid:e.uuid}).then((function(o){0==o.code?n.setState({title:o.result.exchangeName||"",text:o.result.exchangeText,isOpen:!0,exchangeData:e}):Object(d.showToast)({icon:"none",title:o.msg||"兑换失败，请稍后重试"})})).catch((function(e){Object(d.showToast)({icon:"none",title:e.msg||"兑换失败，请稍后重试"})}))}else this.toUse(e)}}]),couponTab}(C.Component);o.default=L},25:function(e,o,t){e.exports={"alert-box":"poupEnvelopes-module__alert-box___2Nr_H",close:"poupEnvelopes-module__close___2qEDt",close_find:"poupEnvelopes-module__close_find___rc1fR",alert_box_wrap:"poupEnvelopes-module__alert_box_wrap___3GuPm",title:"poupEnvelopes-module__title___34M1f",couponBox:"poupEnvelopes-module__couponBox___3nSEh",leftCouponBoxOld:"poupEnvelopes-module__leftCouponBoxOld___DinEh",leftCouponMon:"poupEnvelopes-module__leftCouponMon___3P97m",leftCouponUnit:"poupEnvelopes-module__leftCouponUnit___2pEPo",leftCouponLimit:"poupEnvelopes-module__leftCouponLimit___3Ut7j",leftCouponBox:"poupEnvelopes-module__leftCouponBox___3bkv0",marTop2:"poupEnvelopes-module__marTop2___3eHG1",leftCouponAllance:"poupEnvelopes-module__leftCouponAllance___4Ne2f",leftCouponAllanceStar:"poupEnvelopes-module__leftCouponAllanceStar___1kkNx",exchangeIMg:"poupEnvelopes-module__exchangeIMg___FzySL",rtRedBox:"poupEnvelopes-module__rtRedBox___xtac3",rtRedBoxNum:"poupEnvelopes-module__rtRedBoxNum___2WoSz",rtRedBoxUnit:"poupEnvelopes-module__rtRedBoxUnit___3Uz1d",rtRedBoxTxt:"poupEnvelopes-module__rtRedBoxTxt___1pATM",rtCouponBox:"poupEnvelopes-module__rtCouponBox___1hzjj",rtCouponLogoBox:"poupEnvelopes-module__rtCouponLogoBox___1o3rP",rtCouponLogo:"poupEnvelopes-module__rtCouponLogo___276ew","alert-box-bottom":"poupEnvelopes-module__alert-box-bottom___1GDAR","alert-box-btn":"poupEnvelopes-module__alert-box-btn___1y6fz",popBox:"poupEnvelopes-module__popBox___3ybBQ",popTit:"poupEnvelopes-module__popTit___1tOBd",popCouponBox:"poupEnvelopes-module__popCouponBox___1D-5v",popCouponLeft:"poupEnvelopes-module__popCouponLeft___3MZE7",popCouponUnit:"poupEnvelopes-module__popCouponUnit___A3uhN",popCouponRt:"poupEnvelopes-module__popCouponRt___1wLr8",popName:"poupEnvelopes-module__popName___WOXL5",popInfo:"poupEnvelopes-module__popInfo___Q2KnB",popBtn:"poupEnvelopes-module__popBtn___2hVFY",popCouponBox2:"poupEnvelopes-module__popCouponBox2___1VfNq","alert-box-wrap":"poupEnvelopes-module__alert-box-wrap___268ZA","alert-box-content-bottom-new":"poupEnvelopes-module__alert-box-content-bottom-new___1ykwY",couponName:"poupEnvelopes-module__couponName___2y355",couponType:"poupEnvelopes-module__couponType___kkywo",couponTime:"poupEnvelopes-module__couponTime___FRHta"}},28:function(e,o,t){e.exports={"alert-box":"poupEnvelopes-module__alert-box___3ZV8M",close:"poupEnvelopes-module__close___YSJMQ",rtRedBox:"poupEnvelopes-module__rtRedBox___2gMrO",rtRedBoxNum:"poupEnvelopes-module__rtRedBoxNum___1PpuH",rtRedBoxUnit:"poupEnvelopes-module__rtRedBoxUnit___3u_MW",rtRedBoxTxt:"poupEnvelopes-module__rtRedBoxTxt___3TLPA",alert_box_wrap:"poupEnvelopes-module__alert_box_wrap___wq_4t",title:"poupEnvelopes-module__title___3Bfmm",subTitle:"poupEnvelopes-module__subTitle___qstYZ",couponBox:"poupEnvelopes-module__couponBox___2IrLs",leftCouponBox:"poupEnvelopes-module__leftCouponBox___1_nUF",marTop2:"poupEnvelopes-module__marTop2___17pQI",leftCouponMon:"poupEnvelopes-module__leftCouponMon___1dJbk",leftCouponAllance:"poupEnvelopes-module__leftCouponAllance___SLtnA",leftCouponAllanceStar:"poupEnvelopes-module__leftCouponAllanceStar___3F-Qw",exchangeIMg:"poupEnvelopes-module__exchangeIMg___23r_B",rtCouponBox:"poupEnvelopes-module__rtCouponBox___2MvUG",rtCouponLogoBox:"poupEnvelopes-module__rtCouponLogoBox___1gkG2",rtCouponLogo:"poupEnvelopes-module__rtCouponLogo___3dweR",leftCouponUnit:"poupEnvelopes-module__leftCouponUnit___3g7gA",leftCouponLimit:"poupEnvelopes-module__leftCouponLimit___Xz68g","alert-box-bottom":"poupEnvelopes-module__alert-box-bottom___3LpfW","alert-box-btn":"poupEnvelopes-module__alert-box-btn___2SExj","cancel-box-btn":"poupEnvelopes-module__cancel-box-btn___pUnfC","alert-box-wrap":"poupEnvelopes-module__alert-box-wrap___d4D8o","alert-box-content-bottom-new":"poupEnvelopes-module__alert-box-content-bottom-new___2yNpD",couponName:"poupEnvelopes-module__couponName___qbEh-",couponType:"poupEnvelopes-module__couponType___3qfml",couponTime:"poupEnvelopes-module__couponTime___2KLLi"}},34:function(e,o,t){e.exports={loading:"index-module__loading___2Il2F",loadSize:"index-module__loadSize___3_zN-",loaderWrap:"index-module__loaderWrap___1PH_Q",loader:"index-module__loader___mMqg3"}},36:function(e,o,t){e.exports={wrap:"index-module__wrap___3b_yE",hide:"index-module__hide___1uJrW",case:"index-module__case___3i4KY",content:"index-module__content___1259D",close:"index-module__close___Dbzja"}},41:function(e,o,t){e.exports={couponTabPage:"index-module__couponTabPage___2Gu7y",packageBox:"index-module__packageBox___mHn2H",tabBox:"index-module__tabBox___2R3FP",tabT:"index-module__tabT___276-8",tab_active:"index-module__tab_active___1asdL",tabLine:"index-module__tabLine___2l1qx",couponBox:"index-module__couponBox___1FMri",couponBoxMax:"index-module__couponBoxMax___2P4WZ",s_time:"index-module__s_time___1Dzd8",label:"index-module__label___1bKB9",MonBox:"index-module__MonBox___3pZhp",MonNum:"index-module__MonNum___o2Upp",MonUnit:"index-module__MonUnit___3Ug-F",description:"index-module__description___3laHc",conCenterBox:"index-module__conCenterBox___3I5EN",couponName:"index-module__couponName___2-FDO",couponLimit:"index-module__couponLimit___mOaLK",couponTime:"index-module__couponTime___1meX3",conRtBox:"index-module__conRtBox___3SwSy",useBtn:"index-module__useBtn___2I2Wq",listEmpty:"index-module__listEmpty___vphhi",emptyImg:"index-module__emptyImg___2jPui",emptyTxt:"index-module__emptyTxt___3zt3k",allowanceTop:"index-module__allowanceTop___2hNGq",topLt:"index-module__topLt___EYPCu",title:"index-module__title___2oVju",titleI:"index-module__titleI___2mLMr",subT:"index-module__subT___1Qmjh",topRt:"index-module__topRt___39BrG",topRt_unit:"index-module__topRt_unit___2kKio",topRt_num:"index-module__topRt_num___3yDVq",popSty:"index-module__popSty___21LZh",btnBox:"index-module__btnBox___3VyOd",btn_know:"index-module__btn_know___2FZjh",btn_rent:"index-module__btn_rent___1PPYU",v_coupon_box:"index-module__v_coupon_box___3YFci",cancel_pop:"index-module__cancel_pop___2h3ht",cancel_dialog:"index-module__cancel_dialog___B33VV",load_more:"index-module__load_more___3BUyP"}},50:function(e,o,t){"use strict";var n=t(6),a=t(7),c=t(8),i=t(9),s=t(1),l=t(34),u=t.n(l),r=t(5),p=t(0),d=function(e){Object(c.a)(Loading,e);var o=Object(i.a)(Loading);function Loading(e){var t;return Object(n.a)(this,Loading),(t=o.call(this,e)).state={loadImg:"https://storage.360buyimg.com/wximg/common/loading.gif"},t}return Object(a.a)(Loading,[{key:"render",value:function render(){var e=this.state.loadImg;return this.props.selfStyle?Object(p.jsx)(s.j,{className:u.a.loaderWrap,children:Object(p.jsx)(s.j,{className:u.a.loader})}):Object(p.jsx)(s.j,{className:u.a.loading,children:Object(p.jsx)(s.c,{className:u.a.loadSize,src:e})})}}]),Loading}(r.default.Component);o.a=d},57:function(e,o,t){"use strict";var n=t(6),a=t(7),c=t(8),i=t(9),s=t(1),l=t(5),u=t(36),r=t.n(u),p=t(0),d=function(e){Object(c.a)(Pop,e);var o=Object(i.a)(Pop);function Pop(){return Object(n.a)(this,Pop),o.apply(this,arguments)}return Object(a.a)(Pop,[{key:"render",value:function render(){var e=null,o=this.props.defineSelf;return this.props.isNeedCloseIcon||(e=Object(p.jsx)(s.j,{className:r.a.close,onClick:this.onClosePop.bind(this)})),Object(p.jsx)(s.j,{className:"".concat(r.a.wrap," ").concat(this.props.isShow?"":r.a.hide," "),onClick:this.onClosePop.bind(this),children:Object(p.jsxs)(s.j,{className:r.a.case,onClick:this.onClickPop.bind(this),children:[o?Object(p.jsx)(s.j,{children:this.props.children}):Object(p.jsx)(s.j,{className:r.a.content,style:{background:this.props.bgColor?this.props.bgColor:"#fff"},children:this.props.children}),e]})})}},{key:"onClosePop",value:function onClosePop(e){console.log("===onClosePop===",e),e.stopPropagation(),this.props.onPopEvent({type:"close"})}},{key:"onClickPop",value:function onClickPop(e){e.stopPropagation(),this.props.onPopEvent({type:"content",params:{}})}}]),Pop}(l.Component);o.a=d},82:function(e,o,t){e.exports={wrap:"index-module__wrap___1NAlT",hide:"index-module__hide___3uIy2",case:"index-module__case___npf8U",content:"index-module__content___qmjJP",titlecss:"index-module__titlecss___HZaii",textcss:"index-module__textcss___1quEG",main:"index-module__main___2jb5h",btnarea:"index-module__btnarea___N9l8B",confirm:"index-module__confirm___2r5J4",cancel:"index-module__cancel___3RT73"}},90:function(e,o,t){"use strict";var n=t(6),a=t(7),c=t(15),i=t(8),s=t(9),l=t(10),u=t(3),r=t.n(u),p=t(5),d=t(16),_=t(14),m=t(1),h=t(25),b=t.n(h),x=t(35),j=t(69),g=t(0),f=function(e){Object(i.a)(PoupEnvelopes,e);var o=Object(s.a)(PoupEnvelopes);function PoupEnvelopes(e){var t,a,i;return Object(n.a)(this,PoupEnvelopes),i=o.call(this,e),Object(l.a)(Object(c.a)(i),"confirmExchange",(function(e){var o;e.preventDefault(),e.stopPropagation();var t=i.props,n=t.item,a=t.consumeCode,c=t.exchangeData;console.log("this.props",i.props.item);var s={exchangeId:c.id||"",pin:Object(x.a)("PDJ_H5_PIN")||Object(x.a)("pin")||Object(x.a)("PDJ_H5_JDPIN"),activityCode:(null==n||null===(o=n.bestExchangeCouponInfo)||void 0===o?void 0:o.activityCode)||"",consumeCode:a||"",grabChannel:"vip_index_page",platform:"H5",serviceVersion:"2",requestor:"vplus"};Object(d.e)(s).then((function(e){0==e.code?(r.a.showToast({title:e.msg||"兑换成功，快去下单吧～",icon:"none",duration:1500}),i.closeExchangePop(),i.props.type&&"allowance"==i.props.type&&Object(_.a)({page_name:"VIP_page_name",create_time:new Date,click_id:"clickButton",click_par:{type:"change",btnName:c.buttonTitle}}),i.refreshPage()):r.a.showToast({title:e.msg,icon:"none",duration:1500})})).catch((function(e){r.a.showToast({title:e.msg,icon:"none",duration:1500})})),Object(_.a)({create_time:new Date,click_id:"exchangeCouponVender",click_par:{isPaid:1}})})),Object(l.a)(Object(c.a)(i),"closeBtn",(function(){i.props.closeExchangePop()})),i.state={params:(null===(t=r.a.getCurrentInstance())||void 0===t||null===(a=t.router)||void 0===a?void 0:a.params)||{},showPop:!1,closePop:!1,popData:{activityCode:"",couponId:"",markState:""}},i}return Object(a.a)(PoupEnvelopes,[{key:"componentDidMount",value:function componentDidMount(){this.props.type&&"allowance"==this.props.type&&Object(_.a)({page_name:"VIP_page_name",create_time:new Date,click_id:"showLayer",click_par:{type:"change"}})}},{key:"render",value:function render(){var e=this.state,o=e.params,t=(e.showPop,e.closePop),n=this.props.exchangeData||{},a=n.sourcePackage,c=n.targetPackage,i=n.storeLogo,s=n.exchangeFlag;return Object(g.jsx)(m.a,{children:t?"":Object(g.jsxs)(m.j,{onClick:this.closeBtn.bind(this),className:b.a["alert-box"],children:[Object(g.jsxs)(m.j,{className:b.a.alert_box_wrap,children:[Object(g.jsx)(m.j,{className:b.a.title,children:"津贴兑换会员专享券"}),Object(g.jsxs)(m.j,{className:b.a.couponBox,children:[5==s||6==s?Object(g.jsxs)(m.j,{className:[b.a.leftCouponBox,6==s?"":b.a.marTop2].join(" "),children:[Object(g.jsx)(m.j,{className:b.a.leftCouponAllance,children:Object(g.jsx)(m.c,{className:b.a.leftCouponAllanceStar,src:"https://storage.360buyimg.com/wximg/member/allance-re.png"})}),Object(g.jsxs)(m.j,{className:b.a.leftCouponMon,children:[a.amount,"元津贴"]})]}):Object(g.jsxs)(m.j,{className:b.a.leftCouponBoxOld,children:[Object(g.jsxs)(m.j,{className:b.a.leftCouponMon,children:[a.amount,Object(g.jsx)(m.i,{className:b.a.leftCouponUnit,children:"元"})]}),Object(g.jsx)(m.j,{className:b.a.leftCouponLimit,children:a.limitRule||a.couponTypeDesc||"满29元可用"})]}),Object(g.jsx)(m.j,{className:b.a.exchangeIMg}),6==s?Object(g.jsxs)(m.j,{className:b.a.rtRedBox,children:[Object(g.jsxs)(m.j,{className:b.a.rtRedBoxNum,children:[c.amount,Object(g.jsx)(m.i,{className:b.a.rtRedBoxUnit,children:"元"})]}),Object(g.jsx)(m.j,{className:b.a.rtRedBoxTxt,children:"V+会员红包"})]}):Object(g.jsxs)(m.j,{className:b.a.rtCouponBox,children:[Object(g.jsx)(m.j,{className:b.a.rtCouponLogoBox,children:Object(g.jsx)(m.c,{className:b.a.rtCouponLogo,src:i||"https://storage.360buyimg.com/wximg/common/logo.jpg"})}),Object(g.jsxs)(m.j,{className:b.a.leftCouponMon,children:[c.amount,Object(g.jsx)(m.i,{className:b.a.leftCouponUnit,children:"元"})]}),Object(g.jsx)(m.j,{className:b.a.leftCouponLimit,children:5==s?c.couponTypeDesc:c.limitRule||"满29元可用"})]})]}),Object(g.jsx)(m.j,{className:b.a["alert-box-bottom"],children:Object(g.jsx)(m.j,{className:b.a["alert-box-btn"],onClick:this.confirmExchange.bind(this),children:5==s||6==s?"兑换会员专享券":"兑换红包"})})]}),Object(g.jsx)(m.j,{className:[b.a.close,"findpage"==o.channel?b.a.close_find:""].join(" "),onClick:this.closeBtn.bind(this)})]})})}},{key:"jumpToUrl",value:function jumpToUrl(){var e=this.state.popData||{},o=e.couponId,t=e.activityCode,n={markState:e.markState,code:t};Object(j.a)({couponId:o,code:t,passThroughParam:n})}},{key:"closeExchangePop",value:function closeExchangePop(){this.props.closeExchangePop()}},{key:"refreshPage",value:function refreshPage(){this.props.refreshPage()}}]),PoupEnvelopes}(p.default.Component);o.a=f}},[[204,0,17]]]);