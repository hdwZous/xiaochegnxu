"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _class,_temp2,_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a,o=arguments[t];for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},_createClass=function(){function o(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,a){return t&&o(e.prototype,t),a&&o(e,a),e}}(),_get=function e(t,a,o){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,a);return void 0!==n?"value"in n?n.value:void 0!==(n=n.get)?n.call(o):void 0:null!==(n=Object.getPrototypeOf(t))?e(n,a,o):void 0},_index=require("../../../npm/@tarojs/taro-weapp/index.js"),_index2=_interopRequireDefault(_index),_indexWeapp=require("../../../npm/@jd/djmp/common-t/js/bi/index.weapp.js"),_indexWeapp2=require("../../../npm/@jd/djmp/common-t/js/login/index.weapp.js"),_indexWeapp3=require("../../../npm/@jd/djmp/common-t/js/jump/index.weapp.js"),_indexWeapp4=require("../../../npm/@jd/djmp/common-t/js/taroapi/index.weapp.js"),_phoneCharge=require("../api/phoneCharge.js"),_indexWeapp5=require("../../../npm/@jd/djmp/common-t/js/env/index.weapp.js"),_indexModuleScssMap=require("./index.module.scss.map.js"),_indexModuleScssMap2=_interopRequireDefault(_indexModuleScssMap);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}_temp2=_class=function(){function r(){var e,t;_classCallCheck(this,r);for(var a=arguments.length,o=Array(a),n=0;n<a;n++)o[n]=arguments[n];return(e=t=_possibleConstructorReturn(this,(t=r.__proto__||Object.getPrototypeOf(r)).call.apply(t,[this].concat(o)))).$usedState=["isPhoneX","style","isError","anonymousState__temp","anonymousState__temp2","anonymousState__temp3","anonymousState__temp4","anonymousState__temp5","lastPage","result","params","firstGridData","pageNo","loadSwitch","goodsList"],t.config={navigationBarTitleText:"支付结果",onReachBottomDistance:10},t.customComponents=["Grid"],_possibleConstructorReturn(t,e)}return _inherits(r,_index.Component),_createClass(r,[{key:"_constructor",value:function(e){_get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"_constructor",this).call(this,e),this.state={result:{},params:{},firstGridData:{},pageNo:1,loadSwitch:!0,lastPage:!1,goodsList:[],isError:!1,isPhoneX:!1},this.$$refs=[]}},{key:"_createData",value:function(){this.__state=arguments[0]||this.state||{},this.__props=arguments[1]||this.props||{};var e=this.$prefix,t=this.__state,a=(t.lastPage,t.isError),t=(t.isPhoneX,a?this._createErrorData(e+"ppsWRNRtLw")():null),a=this._createResultData(e+"pTouyjTQQg")(),o=this._createBtnData(e+"yeLdvxXtBT")(),n=this._createBannerData(e+"yHqnLqSaIm")(),e=this._createGoodsListData(e+"GUpPyjVqUY")();return Object.assign(this.__state,{style:_indexModuleScssMap2.default,anonymousState__temp:t,anonymousState__temp2:a,anonymousState__temp3:o,anonymousState__temp4:n,anonymousState__temp5:e}),this.__state}},{key:"componentDidMount",value:function(){var t=this;this.setState({params:this.$router.params},function(){(0,_indexWeapp2.isLogin)().then(function(e){t.fetchData()}).catch(function(){(0,_indexWeapp2.goToLogin)({localTargetUrl:"/pages/phoneCharge-t/payResult/index?orderId="+t.$router.params.orderId})})})}},{key:"componentDidShow",value:function(){(0,_indexWeapp.pvReport)({create_time:new Date});var e=this.isPhoneX();this.setState({isPhoneX:e})}},{key:"fetchData",value:function(){var o=this,e=this.state.params.orderId,t=this.state,a=t.pageNo,t=t.goodsList,n=void 0===t?[]:t;e?(0,_phoneCharge.rechargePaymentResult)({orderId:e,pageSize:10,pageNo:a}).then(function(e){(0,_indexWeapp4.hideLoading)();var t,e=e.result,a={loadSwitch:!0,result:e};a=e.productInfo&&0==e.productInfo.length||!e.productInfo?_extends({},a,{lastPage:!0}):(t=n.concat(e.productInfo),_extends({},a,{lastPage:!1,goodsList:t})),e.resourceNicheEntity&&e.resourceNicheEntity.resourcesList&&0!=e.resourceNicheEntity.resourcesList.length&&(a=_extends({},a,{firstGridData:e.resourceNicheEntity})),o.setState(a)}).catch(function(e){(0,_indexWeapp4.hideLoading)(),o.setState({loadSwitch:!0,isError:!0}),(0,_indexWeapp4.showToast)({title:e.msg||"获取结果失败"})}):(0,_indexWeapp4.showToast)({title:"orderid不存在"})}},{key:"componentDidUpdate",value:function(){}},{key:"_createErrorData",value:function(e){return function(){return{style:_indexModuleScssMap2.default}}}},{key:"_createResultData",value:function(e){var t=this;return function(){var e=t.state.result.orderDetails;return{style:_indexModuleScssMap2.default,orderDetails:void 0===e?{}:e}}}},{key:"_createBtnData",value:function(e){return function(){return{style:_indexModuleScssMap2.default}}}},{key:"_createBannerData",value:function(a){var o=this;return function(){var e=(0,_index.genCompid)(a+"$compid__133"),t=o.state.firstGridData,t=void 0===t?{}:t;return t&&_index.propsManager.set({pageFrom:"phoneCharge",data:t},e),{$compid__133:e,firstGridData:t,style:_indexModuleScssMap2.default}}}},{key:"onReachBottom",value:function(){var e=this,t=this.state,a=t.lastPage,o=t.pageNo,t=t.loadSwitch;!a&&t&&this.setState({pageNo:o+1,loadSwitch:!1},function(){e.fetchData()})}},{key:"getDeviceInfo",value:function(){var e="weapp";return e="weapp"===e?"WECHAT":_indexWeapp5.isJDApp?_indexWeapp5.isJDReactNativeWebView?"JD_RN":"JD_H5":_indexWeapp5.isDaojiaApp?"APP":"H5"}},{key:"_createGoodsListData",value:function(e){var t=this;return function(){var e=t.state.goodsList,a=void 0===e?[]:e;return{loopArray14:a.length?a.map(function(e,t){return e={$original:(0,_index.internal_get_original)(e)},{$loopState__temp7:a.length?"goods"+t:null,$original:e.$original}}):[],goodsList:a,style:_indexModuleScssMap2.default}}}},{key:"goToStore",value:function(e){(0,_indexWeapp.clickReport)({create_time:new Date,click_id:"clickSku",click_par:{skuid:e.skuId}}),(0,_indexWeapp3.jump)({to:"store",params:{storeId:e.storeId,skuId:e.skuId,orgCode:e.orgCode}})}},{key:"onClickBtn",value:function(e,t){"chargeCenter"==e?((0,_indexWeapp.clickReport)({create_time:new Date,click_id:"clickBackRechargePage"}),(0,_indexWeapp4.navigateTo)("/pages/phoneCharge-t/index")):((0,_indexWeapp.clickReport)({create_time:new Date,click_id:"clickBackHomePage"}),(0,_indexWeapp3.jump)({to:"home"}))}},{key:"isPhoneX",value:function(){return getApp().globalData.isIpx}}]),r}(),_class.$$events=["onClickBtn","goToStore"],_class.multipleSlots=!0,_class.$$componentPath="pages/phoneCharge-t/payResult/index";var payResult=_temp2;exports.default=payResult,Component(require("../../../npm/@tarojs/taro-weapp/index.js").default.createComponent(payResult,!0));