"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _class,_temp2,_createClass=function(){function n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}}(),_get=function e(t,o,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,o);return void 0!==i?"value"in i?i.value:void 0!==(i=i.get)?i.call(n):void 0:null!==(i=Object.getPrototypeOf(t))?e(i,o,n):void 0},_index=require("../../../../../npm/@tarojs/taro-weapp/index.js"),_index2=_interopRequireDefault(_index),_indexWeapp=require("../../../../../npm/@jd/djmp/common-t/js/storage/index.weapp.js"),_indexWeapp2=require("../../../../../npm/@jd/djmp/common-t/js/taroapi/index.weapp.js"),_indexWeapp3=require("../../../../../npm/@jd/djmp/common-t/js/env/index.weapp.js"),_indexWeapp4=require("../../../../../npm/@jd/djmp/common-t/js/jump/index.weapp.js"),_indexWeapp5=require("../../../../../npm/@jd/djmp/common-t/js/bi/index.weapp.js"),_goToByCouponWeapp=require("../../../../../npm/@jd/djmp/common-t/js/utils/goToByCoupon.weapp.js"),_indexModuleScssMap=require("./index.module.scss.map.js"),_indexModuleScssMap2=_interopRequireDefault(_indexModuleScssMap);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var isWeapp=!0,SignRewardPop=(_temp2=_class=function(){function r(){var e,t;_classCallCheck(this,r);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];return(e=t=_possibleConstructorReturn(this,(t=r.__proto__||Object.getPrototypeOf(r)).call.apply(t,[this].concat(n)))).$usedState=["anonymousState__temp18","isFirstClickPushSw","pagePushSwitch","isShowPushSwitch","isOpenPushStatus","pushSwitch","refreshPushSwitchStatus","couponList","tomorrowReward","signPoint","handleSysPushPop","closeSignRewardLayer","closeSignRewardLayerOnly","callToBottomList","address"],t.customComponents=[],_possibleConstructorReturn(t,e)}return _inherits(r,_index.Component),_createClass(r,[{key:"_constructor",value:function(e){_get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"_constructor",this).call(this,e),this.state={isFirstClickPushSw:1,pagePushSwitch:!1,isShowPushSwitch:!1},this.$$refs=[]}},{key:"componentDidMount",value:function(){this.checkPushClick();var e=this.props,t=e.isOpenPushStatus,e=e.pushSwitch;1==e&&0==t?(this.props.refreshPushSwitchStatus(0),this.setState({isShowPushSwitch:!0,pagePushSwitch:!1})):1==e&&1==t?this.setState({isShowPushSwitch:!1,pagePushSwitch:!0}):this.setState({isShowPushSwitch:!0,pagePushSwitch:!1})}},{key:"componentWillReceiveProps",value:function(e){var t=e.isOpenPushStatus,e=e.pushSwitch;1==e&&0==t?(this.props.refreshPushSwitchStatus(0),this.setState({pagePushSwitch:!1})):1==e&&1==t?this.setState({pagePushSwitch:!0}):this.setState({pagePushSwitch:!1})}},{key:"checkPushClick",value:function(){var e=(0,_indexWeapp.getStorageSync)("isFirstClickPushSw")||1;this.setState({isFirstClickPushSw:e})}},{key:"_createSignRewardLayerData",value:function(c){var l=this;return function(){var e=l.props,t=e.couponList,t=void 0===t?[]:t,o=e.tomorrowReward,o=void 0===o?{}:o,e=e.signPoint,n=l.state,i=n.isFirstClickPushSw,r=n.pagePushSwitch,n=n.isShowPushSwitch,a=0==o.rewardType?l._createTomorrowCouponData(c+"TisuSodtAR")():null,s=1==o.rewardType?l._createTomorrowCouponData(c+"pBQsEyZnHi")():null,p=2==o.rewardType?l._createTomorrowMemberData(c+"nWOHOTITwL")():null,u=3==o.rewardType?l._createTomorrowCouponData(c+"qFFDNTxQhH")():null;return{anonymousState__temp17:t&&0<t.length?(0,_index.internal_inline_style)(2<t.length?{overflow:scroll}:""):null,loopArray150:t&&0<t.length?t.map(function(e,t){return{$loopState__temp2:0==(e={$original:(0,_index.internal_get_original)(e)}).$original.rewardType?l._createTodayCouponData(c+"ZrpBXHpjOF"+t)(e.$original):null,$loopState__temp4:1==e.$original.rewardType?l._createTodayCouponData(c+"gtuJUUyJRh"+t)(e.$original):null,$loopState__temp6:2==e.$original.rewardType?l._createTodayMemberData(c+"dclMhrTgRm"+t)(e.$original):null,$loopState__temp8:3==e.$original.rewardType?l._createTodayCouponData(c+"XBKbysLpFx"+t)(e.$original):null,$loopState__temp10:1==e.$original.extraRewardType?l._createExtraCouponData(c+"WyRLDpsqBq"+t)(e.$original):null,$loopState__temp12:2==e.$original.extraRewardType?l._createExtraCouponData(c+"ccRpttfuQI"+t)(e.$original):null,$original:e.$original}}):[],style:_indexModuleScssMap2.default,tomorrowReward:o,undefined:void 0,couponList:t,anonymousState__temp13:a,anonymousState__temp14:s,anonymousState__temp15:p,anonymousState__temp16:u,isDaojiaApp:_indexWeapp3.isDaojiaApp,djAppVersion:_indexWeapp3.djAppVersion,isShowPushSwitch:n,pagePushSwitch:r,isFirstClickPushSw:i,signPoint:e}}}},{key:"openSysPushSwitch",value:function(){(0,_indexWeapp.setStorageSync)("isFirstClickPushSw",0),this.checkPushClick();var e=this.props,t=e.isOpenPushStatus,e=(e.pushSwitch,this.state.pagePushSwitch);(0,_indexWeapp5.clickReport)({click_id:"clickPushSwitchOnPopup",click_par:{action:e?"turnOff":"turnOn",systemPushStatus:1==t?"on":"off"}}),e?this.props.refreshPushSwitchStatus(0):1==t?this.props.refreshPushSwitchStatus(1):this.props.handleSysPushPop(!0)}},{key:"_createTodayCouponData",value:function(e){return function(e){e.amount||e.couponPrice;return{afterSignCouponResponse:e,style:_indexModuleScssMap2.default}}}},{key:"_createTomorrowCouponData",value:function(e){var t=this;return function(){return{tomorrowReward:t.props.tomorrowReward,style:_indexModuleScssMap2.default}}}},{key:"_createTodayMemberData",value:function(e){return function(){return{style:_indexModuleScssMap2.default}}}},{key:"_createTomorrowMemberData",value:function(e){return function(){return{style:_indexModuleScssMap2.default}}}},{key:"_createExtraCouponData",value:function(e){return function(e){e.amount||e.couponPrice;return{afterSignCouponResponse:e,style:_indexModuleScssMap2.default}}}},{key:"closeSignRewardLayer",value:function(){this.props.closeSignRewardLayer(!1),(0,_indexWeapp5.clickReport)({click_id:"clickCloseOnCheckinSucceedPopup"})}},{key:"clickStrCoupBtn",value:function(e){(0,_indexWeapp5.clickReport)({click_id:"clickToUseTodayReward",click_par:{type:e.rewardType,code:e.couponId||e.couponCode}}),3==e.rewardType?(0,_indexWeapp4.jump)({type:"",to:"phoneCharge"}):(this.props&&this.props.closeSignRewardLayerOnly&&this.props.closeSignRewardLayerOnly(),e.ifFull?this.props&&this.props.callToBottomList&&this.props.callToBottomList():this.goToCouponPage(e))}},{key:"goToCouponPage",value:function(e){var t=this.props.address,o=t.longitude,n=t.latitude,t=t.cityId||t.areaCode||t.cityCode||"",i={};i.couponId=e.couponId||couponCode,i.longitude=o,i.latitude=n,i.cityId=t,(0,_goToByCouponWeapp.goToByCouponId)(i)}},{key:"clickMemberBtn",value:function(){(0,_indexWeapp2.navigateTo)("/pages/vpayMember-t/home/index")}},{key:"_createData",value:function(){this.__state=arguments[0]||this.state||{},this.__props=arguments[1]||this.props||{};var e=this.$prefix,e=this._createSignRewardLayerData(e+"cYizCMlneh")();return Object.assign(this.__state,{anonymousState__temp18:e}),this.__state}}]),r}(),_class.$$events=["closeSignRewardLayer","openSysPushSwitch","clickStrCoupBtn","clickMemberBtn","clickStrCoupBtn"],_class.multipleSlots=!0,_class.$$componentPath="pages/tabBar/signIn-t/components/SignRewardPop/index",_temp2);exports.default=SignRewardPop,Component(require("../../../../../npm/@tarojs/taro-weapp/index.js").default.createComponent(SignRewardPop));