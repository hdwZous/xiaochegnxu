"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(o){for(var e=1;e<arguments.length;e++){var n,t=arguments[e];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n])}return o};exports.goToByCouponId=goToByCouponId,exports.goToByCouponIdOpenApp=goToByCouponIdOpenApp,exports.jumpCase=jumpCase,exports.jumpCaseOpenAPP=jumpCaseOpenAPP;var _index=require("../../../../../@tarojs/taro-weapp/index.js"),_index2=_interopRequireDefault(_index),_indexWeapp=require("../http/index.weapp.js"),_indexWeapp2=require("../taroapi/index.weapp.js");function _interopRequireDefault(o){return o&&o.__esModule?o:{default:o}}var singleCouponTreadyFun=function(){return(0,_indexWeapp.request)({functionId:"coupon/singleCouponTready",body:JSON.stringify(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),method:"GET"})};function goToByCouponId(e){var o=e.couponId,n=e.code,t=e.passThroughParam;singleCouponTreadyFun({couponGoSource:1<arguments.length&&void 0!==arguments[1]?arguments[1]:3,couponId:o,passThroughParam:t=!t&&n?{code:n}:t}).then(function(o){0==o.code?jumpCase(_extends({},o.result,e)):wx.showToast({title:o.msg||"网络开小差，请稍后重试",icon:"none",duration:1500})}).catch(function(o){wx.showToast({title:o.msg||"网络开小差，请稍后重试",icon:"none",duration:1500})})}function goToByCouponIdOpenApp(e){var o=e.couponId;singleCouponTreadyFun({couponGoSource:1<arguments.length&&void 0!==arguments[1]?arguments[1]:3,couponId:o}).then(function(o){0==o.code?jumpCaseOpenAPP(_extends({},o.result,e)):wx.showToast({title:o.msg||"网络开小差，请稍后重试",icon:"none",duration:1500})}).catch(function(o){wx.showToast({title:o.msg||"网络开小差，请稍后重试",icon:"none",duration:1500})})}function parseParams(o){o.params=_extends({},o.params,o.params.passThroughParam);var e="";o.userAction&&(e=encodeURIComponent(o.userAction));var n,t,i="";for(n in o.params)"isAddCart"==n&&(t=o.params[n]+"",o.params[n]="true"==t||""),i+="&"+n+"="+(o.params[n]||"");return i="{}"==JSON.stringify(o.params)?"?userAction="+e:"?"+i.slice(1)+"&userAction="+e}function jumpCase(o){console.log("jumpCase",o);var e=o.to,n=o.longitude,t=void 0===n?"":n,i=o.latitude,a=void 0===i?"":i,p=o.cityId,d=void 0===p?"":p,s=o._homeToStoreList,r=void 0!==s&&s,u=o.params,c=void 0===u?{}:u,m=o.code,n=c||{},i=n.limitId,p=void 0===i?"":i,s=n.storeId,u=void 0===s?"":s,m=n.orgCode,i=void 0===m?"":m,s=n.jumpType,m=n.skuId,n=void 0===m?"":m;e?(m="","storeList"===e?(0,_indexWeapp2.navigateTo)(m="/pages/purchTicket/purchTicketsStoreList/storeList?promotionInfoId="+p+"&jumpType="+(void 0===s?"":s)+"&longitude="+t+"&latitude="+a+"&cityId="+d):"goodsList"===e?(0,_indexWeapp2.navigateTo)(m="/pages/purchTicket/purchTickets/purchTickets?stationNo="+u+"&couponId="+p+"&longitude="+t+"&latitude="+a+"&orgCode="+i):"store"===e?(0,_indexWeapp2.navigateTo)(m="/pages/store/index?storeId="+(u||"")+"&orgCode="+(i||"")+"&skuId="+(n||"")+"&couponId="+(p||"")+"&longitude="+(t||"")+"&latitude="+(a||"")+"cityId="+(d||"")):"home"===e?r?(0,_indexWeapp2.navigateTo)("/pages/nearbyStore/index"):(0,_indexWeapp2.switchTab)("/pages/home/home"):"couponGoodsList"===e&&c&&c.passThroughParam&&c.passThroughParam.code?(m="/pages/purchTicket/couponGo/index"+parseParams(o),(0,_indexWeapp2.navigateTo)(m)):(0,_indexWeapp2.switchTab)("/pages/home/home")):"home"==o.defaultJump_?(0,_indexWeapp2.switchTab)("/pages/home/home"):wx.showToast({icon:"none",title:"附近没有门店耶~换个地方再试试",duration:2e3})}function jumpCaseOpenAPP(o){var e=o.to,n=(o.longitude,o.latitude,o.cityId,o._homeToStoreList,o.params),t=o.second,i=o.popup,a=o.channel,p=(void 0===n?{}:n)||{},d=p.limitId,s=void 0===d?"":d,r=p.storeId,n=void 0===r?"":r,d=p.orgCode,r=void 0===d?"":d,d=p.jumpType,d=void 0===d?"":d,p=p.skuId,p=void 0===p?"":p;e?"home"===e?window.location.href="openApp.jddj://communication?body="+encodeURIComponent(JSON.stringify({params:{},to:"home"})):"storeList"===e||"goodsList"==e?window.location.href="openApp.jddj://communication?body="+encodeURIComponent(JSON.stringify({params:{limitId:s,jumpType:d||"goodsList"},to:"storeList"})):"store"===e&&(window.location.href="openApp.jddj://communication?body="+encodeURIComponent(JSON.stringify({to:"store",params:{storeId:n||"",skuId:p||"",orgCode:r||"",needAnchorSku:!0,addCart:!0,isAddCart:!0,needAddCar:!0,second:t||"",popup:i||"",channel:a||""}}))):"home"==o.defaultJump_?window.location.href="openApp.jddj://communication?body="+encodeURIComponent(JSON.stringify({params:{},to:"home"})):wx.showToast({icon:"none",title:"附近没有门店耶~换个地方再试试",duration:2e3})}