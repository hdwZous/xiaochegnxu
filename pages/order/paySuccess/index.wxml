<block wx:if="{{!isBack}}">
  <!-- <view class="temp">experName:{{experName}}-prizeList:{{prizeList.length}}-luckyDrawInfo:{{luckyDrawInfo}}</view> -->
  <view class="container" wx:if="{{orderBasicInfo}}" catchtap="elementTracker">
    <navigation
      capsule="{{capsule}}"
      background="#25C156"
      color="white"
      opacity="{{opacity}}"
      pageName="{{orderBasicInfo.pageName}}"
    ></navigation>
    <basic-info
      initData="{{orderBasicInfo}}"
      orderId="{{orderId}}"
      storeId="{{storeId}}"
      orgCode="{{orgCode}}"
      midTelShow="{{midTelShow}}"
      midTelDesc="{{midTelDesc}}"
      storeName="{{storeName}}"
      attention="{{attention}}"
      show="{{show}}"
      pageId="{{recommendObj.pageIdFirstPage}}"
      currentPageName="{{recommendObj.currentPageName}}"
      prePageName="{{recommendObj.prePageName}}"
    ></basic-info>

    <!-- 到店二维码 -->
    <view class="goStore" wx:if="{{locOrderType == 2 && locCodeFloorInfo.locCodeInfo}}">
      <go-store-qr-code locCodeFloorInfo="{{locCodeFloorInfo}}" bind:reloadCode="reloadCode"  pageId="{{recommendObj.pageIdFirstPage}}"
        currentPageName="{{recommendObj.currentPageName}}"
        prePageName="{{recommendObj.prePageName}}"
        payStageType="{{payStageType}}"
        locOrderType="{{locOrderType}}"
        orderId="{{orderId}}">
          <canvas  wx:if="{{!qrcodeUrl}}" slot="qrcode" canvas-id="qrcode"  class="qrcode {{locCodeFloorInfo.locCodeInfo.qrCodeNum.length >= 40 ? 'codeCenter' : ''}}"/>
          <image  wx:if="{{qrcodeUrl}}" slot="qrcode" src="{{qrcodeUrl}}" class="qrcode {{locCodeFloorInfo.locCodeInfo.qrCodeNum.length >= 40 ? 'codeCenter' : ''}}"/>
          <canvas slot="barcode" canvas-id="barcode"  class="barcode" wx:if="{{!barcodeUrl && locCodeFloorInfo.locCodeInfo.qrCodeNum.length < 40}}"/>
          <image  slot="barcode" src="{{barcodeUrl}}" class="barcode" wx:if="{{barcodeUrl && locCodeFloorInfo.locCodeInfo.qrCodeNum.length < 40}}"/>
      </go-store-qr-code>
    </view>





    <!-- 展示转盘或奖品 -->
    <view class="draw-container" wx:if="{{(experName == 'newA' && luckyDrawInfo) || (experName == 'newB' &&  prizeList.length > 0) }}">
      <view class="dash-line"></view>
      <view class="top">
        <view class="title">{{luckyDrawInfo.title || '下单抽抽乐'}}</view>
        <view class="rule-text" wx:if="{{luckyDrawInfo.ruleInfo && luckyDrawInfo.ruleInfo.length}}" bindtap="showRulePop">
          <text class='rule'>活动规则</text>
          <text class="dj_icon ts_next icon-next"></text>
        </view>
      </view>
      <view class="wrapper">
        <!-- 展示转盘 -->
        <block wx:if="{{experName == 'newA' && luckyDrawInfo && prizeList.length <= 0 && !notWin}}">
          <draw orderId="{{orderId}}" initData="{{luckyDrawInfo}}" bind:drawShow="drawShow" bind:getResult="getDrawResult" pageId="{{recommendObj.pageIdFirstPage}}" recommendObj="{{recommendObj}}"></draw>
        </block>
        <!-- 展示奖品 -->
        <block wx:elif="{{experName == 'newB' || prizeList.length > 0 || notWin}}">
          <draw-result title="{{prizeTile}}" experName="{{experName}}" prizeList="{{prizeList}}" notWin="{{notWin}}" pageId="{{recommendObj.pageIdFirstPage}}"
          currentPageName="{{recommendObj.currentPageName}}"
          prePageName="{{recommendObj.prePageName}}"
          traceId="{{traceIdPrize}}"
          ></draw-result>
        </block>
      </view>
    </view>
    <!-- 商品推荐列表 -->
    <recommend wx:if="{{list.length > 0}}" title="{{title}}" list="{{list}}" imgLazyLoad="{{imgLazyLoad}}" pageId="{{recommendObj.pageIdFirstPage}}"
          currentPageName="{{recommendObj.currentPageName}}"
          prePageName="{{recommendObj.prePageName}}"
          traceId="{{traceId}}"></recommend>
  </view>
  <block wx:else>
    <navigation capsule="{{capsule}}" color="black" pageName="京东到家"></navigation>
    <new-default type="{{type}}" tips="{{tips}}" btnText="{{btnText}}" bind:defaultBtnEvent="onDefaultBtnEvent" />
  </block>
  <!-- 大转盘活动规则 -->
  <rule-pop wx:if="{{showRule}}" rules="{{luckyDrawInfo.ruleInfo}}" bind:hideRulePop="hideRulePop"></rule-pop>

  
  <!-- 1：仅返券; 2：仅裂变; 3：裂变和返券同时存在; 4: 仅首单裂变; 5: 首单裂变和返券同时存在; 6、仅达达券; 7、达达券和首单裂变同时存在-->
  <block>
    <dialog wx:if="{{redPackAndCouponInfo.popupType}}" showDialog="{{redPackAndCouponInfo.popupType}}" backgroundColor="{{'transparent'}}" bind:pageEvent="closePop" userScroll="{{false}}">
      <!-- 共节省弹层 -->
      <view class="discount" wx:if="{{orderBasicInfo.totalDiscount}}">
        本单为您共节省<text class="price">{{orderBasicInfo.totalDiscount}}元</text>
      </view>

      <!-- 下单返礼 -->
      <view class="coupon-wrap" wx:if="{{(redPackAndCouponInfo.popupType == 1 || redPackAndCouponInfo.popupType== 5) && redPackAndCouponInfo.returnCoupon.quota > 0}}">
        <view class="info" wx:if="{{redPackAndCouponInfo.returnCoupon.couponBusinessName}}">{{redPackAndCouponInfo.returnCoupon.couponBusinessName}}</view>
        <view class="title">
          <image mode="aspectFit" class="icon-coupon-title" src="https://storage.360buyimg.com/wxmini/map/icon-coupon-head.png" />
          恭喜您获得
          <image mode="aspectFit" class="icon-coupon-title" src="https://storage.360buyimg.com/wxmini/map/icon-coupon-head.png" />
        </view>
        <view class="coupon">
          <view>{{redPackAndCouponInfo.returnCoupon.couponName}}</view>
          <view class="price">
            {{redPackAndCouponInfo.returnCoupon.quota}}<text class="small">元</text>
          </view>
        </view>
        <view class="tip">{{redPackAndCouponInfo.returnCoupon.couponValidTime}}</view>
        <block wx:if="{{redPackAndCouponInfo.popupType == 5}}">
          <image mode="aspectFit" class="icon-foot left" src="https://storage.360buyimg.com/wxmini/map/icon-coupon-foot.png" />
          <image mode="aspectFit" class="icon-foot right" src="https://storage.360buyimg.com/wxmini/map/icon-coupon-foot.png" />
        </block>
      </view>

      <block wx:if="{{redPackAndCouponInfo.popupType == 4 || redPackAndCouponInfo.popupType == 5 || redPackAndCouponInfo.popupType == 7}}">
        <image mode="widthFix" class="{{ redPackAndCouponInfo.popupType==5 ? 'cutOrderBg':'dadaBgAndCutOrder'}}" src="{{redPackAndCouponInfo.cutOrderInfo.imgUrl}}" bind:tap="fissionJump" />
      </block>

      <block wx:if="{{redPackAndCouponInfo.popupType == 7}}">
        <view class="dada-wrap">
          <image mode="aspectFit" class="icon-foot left" src="https://storage.360buyimg.com/wxmini/map/icon-coupon-foot.png" />
          <image mode="aspectFit" class="icon-foot right" src="https://storage.360buyimg.com/wxmini/map/icon-coupon-foot.png" />
        </view>
      </block>

      <block wx:if="{{redPackAndCouponInfo.popupType == 6 || redPackAndCouponInfo.popupType == 7}}">
        <image mode="widthFix" class="{{redPackAndCouponInfo.popupType==6?'dadaBgAndCutOrder':'dadaBg'}}" src="{{redPackAndCouponInfo.dadaCoupon.imgUrl}}" data-item="{{redPackAndCouponInfo.dadaCoupon}}" bind:tap="dadaCouponJump" />
      </block>
    </dialog>
    
    <!-- 本单共节省 -->
    <dialog wx:if="{{!redPackAndCouponInfo.popupType && orderBasicInfo.totalDiscount}}" showDialog="{{orderBasicInfo.totalDiscount}}" useClose='{{false}}' backgroundColor="{{'transparent'}}" bind:pageEvent="closePop" userScroll="{{false}}">
      <view class="discount-only-wrap">
        <image mode="aspectFit" class="bg-dog" src="https://storage.360buyimg.com/wxmini/map/bg-dog.png" />
        <view class="discount-only">
          本单为您共节省
          <view class="price">
            {{orderBasicInfo.yuan}}
            <text class="cent">
              <block wx:if="{{orderBasicInfo.cent}}">.</block>{{orderBasicInfo.cent}}元
            </text>
          </view>
        </view>
        <view class="btn-close">我知道了</view>
      </view>
    </dialog>
  </block>

  <!-- 首单裂变弹层 -->
  <!-- <block wx:elif="{{showFissionOrder}}">
    <dialog showDialog="{{showFissionOrder}}" backgroundColor="{{'transparent'}}" bind:pageEvent="closePop" userScroll="{{false}}">
      <image mode="widthFix" class="cutOrderBg" src="{{fissionImgUrl}}" bind:tap="fissionJump" />
    </dialog>
  </block>-->
  <!-- 添加小程序 -->
  <add-mp selfNav recommendObj="{{recommendObj}}"></add-mp>
  <remind-dialog tips="{{orderBasicInfo.payTailNotifyHint}}"></remind-dialog>
</block>