"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _class,_temp2,_createClass=function(){function a(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}}(),_get=function t(e,n,a){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);return void 0!==r?"value"in r?r.value:void 0!==(r=r.get)?r.call(a):void 0:null!==(r=Object.getPrototypeOf(e))?t(r,n,a):void 0},_index=require("../../../../npm/@tarojs/taro-weapp/index.js"),_index2=_interopRequireDefault(_index),_indexWeapp=require("../../../../npm/@jd/djmp/common-t/js/bi/index.weapp.js"),_indexModuleScssMap=require("./index.module.scss.map.js"),_indexModuleScssMap2=_interopRequireDefault(_indexModuleScssMap),_indexWeapp2=require("../../../../npm/@jd/djmp/common-t/js/taroapi/index.weapp.js"),_hackOrder=require("../../api/hackOrder.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(t)return!e||"object"!=typeof e&&"function"!=typeof e?t:e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var txtArr=["邀请新用户可砍更多","离成功只差一步了","再邀请1人，有机会直接提现"],BargainTargetNew=(_temp2=_class=function(){function o(){var t,e;_classCallCheck(this,o);for(var n=arguments.length,a=Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(a)))).$usedState=["anonymousState__temp3","style","txtArr","isSelf","anonymousState__temp","anonymousState__temp2","cutAmount","targetAmount","refresh","countDown","timer","clicking","targetData","kddSocial","friendInfos","isHelping","cutOrderId","nCardBtn"],e.anonymousFunc3Map={},e.anonymousFunc4Map={},e.customComponents=[],_possibleConstructorReturn(e,t)}return _inherits(o,_index.Component),_createClass(o,[{key:"_constructor",value:function(t){_get(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"_constructor",this).call(this,t),this.shareFlag=!0,this.state={refresh:!0,countDown:{HH:"00",MM:"00",SS:"00"},timer:null,clicking:!1},this.$$refs=[]}},{key:"_createData",value:function(){this.__state=arguments[0]||this.state||{},this.__props=arguments[1]||this.props||{};var t=this.$prefix,e=this.__props.isSelf,n=this.__props.targetData||{},a=n.cutAmount,r=n.targetAmount,n=n.percent,n=void 0===n?"":n,o=(93<=n.split("%")[0]&&n.split("%")[0]<100?n="93%":100==n.split("%")[0]&&(n="98%"),e?this._createSelfInfoData(t+"ylVNXRnObL")():null),t=this._createOthersInfoData(t+"bBHWACwdnE")(),n=(0,_index.internal_inline_style)({width:n});return Object.assign(this.__state,{anonymousState__temp3:n,style:_indexModuleScssMap2.default,txtArr:txtArr,isSelf:e,anonymousState__temp:o,anonymousState__temp2:t,cutAmount:a,targetAmount:r}),this.__state}},{key:"_createSelfInfoData",value:function(l){var p=this;return function(){var t=p.state.countDown,t=void 0===t?{}:t,e=p.props.targetData||{},n=e.cutStatus,n=void 0===n?"":n,e=e.description,e=void 0===e?"":e,a=p.props,r=a.kddSocial,o=a.friendInfos,o=void 0===o?[]:o,a=a.isHelping,i=1==n||3==n||2==n||9==n||10==n?p._createShareBtnData(l+"qBvRuTZwqf")():null,s=4==n?p._createCutEndData(l+"BbuqnUTlnP")():null,u=5==n||6==n||7==n||8==n?p._createTopUpInfoData(l+"UHyRGlNYlF")():null,c="new1"==r&&0<o.length&&a?p._createFriendData(l+"UArRDIsBeb")():null;return{style:_indexModuleScssMap2.default,cutStatus:n,anonymousState__temp4:i,anonymousState__temp5:s,anonymousState__temp6:u,kddSocial:r,friendInfos:o,isHelping:a,anonymousState__temp7:c,description:e,countDown:t}}}},{key:"viewActivety",value:function(){var t=this.props,e=t.isSelf,t=t.cutOrderId,e=(e&&(0,_indexWeapp.clickReport)({create_time:new Date,click_id:"clickfqzymwffq",click_par:{contentId:"check"}}),this.getQuery("source")),n=this.getQuery("createSource")||"";(0,_indexWeapp2.navigateTo)("/pages/hackOrder-t/launch/index?cutOrderId="+t+"&source="+e+"&createSource="+n)}},{key:"getQuery",value:function(t){return this.$router.params[t]}},{key:"_createOthersInfoData",value:function(t){var r=this;return function(){var t=r.state,t=(t.countDown,t.clicking),e=r.props.targetData||{},n=e.helpStatus,n=void 0===n?"":n,a=e.helpCutAmount,e=e.description,e=void 0===e?"":e,a={0:{txt:"帮TA砍一刀",class:"shareFriend"},1:{txt:"已帮"+(void 0===a?0:a)+"元",class:"redGrayBtn"},2:{txt:"帮好友砍价次数已用完",class:"shareFriendGray"},3:{txt:"砍价已结束",class:"shareFriendGray"},4:{txt:"砍价已完成",class:"redGrayBtn"}}[n]||{};return r.anonymousFunc0=0!=n||t?function(){}:function(t){return r.onClickShare(t,"cutFn")},{currentInfo:a,helpStatus:n,style:_indexModuleScssMap2.default,description:e}}}},{key:"_createShareBtnData",value:function(t){var n=this;return function(){var t=n.props,e=t.targetData,t=t.nCardBtn,e=(e||{}).cutStatus,e=void 0===e?"":e;return n.anonymousFunc1=function(t){return n.onClickShare(t,"friend")},{cutStatus:e,style:_indexModuleScssMap2.default,nCardBtn:t}}}},{key:"_createCutEndData",value:function(t){return function(){return{style:_indexModuleScssMap2.default}}}},{key:"_createTopUpInfoData",value:function(t){var a=this;return function(){var t=a.props.targetData||{},e=t.cutStatus,e=void 0===e?"":e,n=t.receivingDay,t=t.targetAmount,n={5:{btnTxt:"收货后"+(void 0===n?3:n)+"天内可来领取奖励",className:"redGrayBtn"},6:{btnTxt:"已超过提现时间",className:"shareFriendGray"},7:{btnTxt:"立即提现",className:"redBtn"},8:{btnTxt:"已到账"+1e3*t+"鲜豆，可抵"+t+"元现金",className:"orangeBigBtn"}}[e],t=_indexModuleScssMap2.default[n.className];return a.anonymousFunc2=7==e?a.doWithdrawal.bind(a):function(){},{classC:t,currentInfo:n}}}},{key:"_createFriendData",value:function(t){var n=this;return function(){var t=n.props.friendInfos,t=void 0===t?[]:t;return{loopArray79:t.length<3?t.map(function(t,e){t={$original:(0,_index.internal_get_original)(t)};e="pvtlY"+e;return n.anonymousFunc3Map[e]=function(t){return n.onClickInvite(t,"friend")},{_$indexKey:e,$original:t.$original}}):[],loopArray80:t.map(function(t,e){t={$original:(0,_index.internal_get_original)(t)};e="LyPVK"+e;return n.anonymousFunc4Map[e]=function(t){return n.onClickInvite(t,"friend")},{_$indexKey2:e,$original:t.$original}}),friendInfos:t,style:_indexModuleScssMap2.default}}}},{key:"componentWillUnmount",value:function(){var t=this.state.timer;t&&clearInterval(t)}},{key:"componentWillUpdate",value:function(){}},{key:"componentDidMount",value:function(){var t=this.props,e=t.targetData,e=void 0===e?{}:e,t=t.isSelf,n=e.endTime,a=e.cutStatus,a=void 0===a?"":a,r=e.helpStatus,r=void 0===r?"":r;this.state.refresh&&e&&n&&((t?1==a||2==a||3==a:1==r||0==r||2==r)&&this.initData())}},{key:"initData",value:function(){var t=this.props.targetData,t=(void 0===t?{}:t).endTime,t=void 0===t?"":t;this.setState({refresh:!1}),this.showCountDown(t)}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.timer)}},{key:"showCountDown",value:function(t){var e=this;this.countDownFn(t,function(t){t.end&&(clearInterval(e.state.timer),e.props.onRefresh());t={HH:t.hour,MM:t.minute,SS:t.second};e.setState({countDown:t})})}},{key:"countDownFn",value:function(a,r){this.state.timer&&(clearInterval(this.state.timer),this.setState({timer:null}));var o=setInterval(function(){var t=0,e=0,n=0;0<a&&(t=Math.floor(a/1e3/60/60),e=Math.floor(a/1e3/60%60),n=Math.floor(a/1e3%60)),t<=9&&(t="0"+t),e<=9&&(e="0"+e),n<=9&&(n="0"+n),r(0<a?{hour:t,minute:e,second:n,timer:o,end:!1}:{hour:"00",minute:"00",second:"00",timer:o,end:!0}),a-=1e3},1e3);this.setState({timer:o})}},{key:"onClickInvite",value:function(t,e){(0,_indexWeapp.clickReport)({create_time:new Date,click_id:"clickyaoqing"}),this.props.onClickShare(t,e)}},{key:"onClickShare",value:function(t,e){var n,a,r,o=this;this.state.clicking||(this.setState({clicking:!0}),n=setTimeout(function(){o.setState({clicking:!1}),clearTimeout(n)},500),"friend"==e?(0,_indexWeapp.clickReport)({create_time:new Date,click_id:"clickfriends",click_par:{contentId:"yqhykj"}}):"moment"==e?(0,_indexWeapp.clickReport)({create_time:new Date,click_id:"clickmorefriends",click_par:{contentId:"share"}}):"friendBtn"==e&&(r=(a=this.props).targetData,a=a.isSelf,r=r.cutStatus,a&&(0,_indexWeapp.clickReport)({create_time:new Date,click_id:"clickfriends",click_par:{contentId:1==r||2==r?"fxzkyd":"yqhykj"}})),this.props.onClickShare(t,e))}},{key:"doWithdrawal",value:function(){var e=this,t=this.props.cutOrderId;(0,_hackOrder.withdrawRequest)({cpOrderInfoId:t}).then(function(t){0==t.code&&((0,_indexWeapp2.showToast)({title:"恭喜，提现成功"}),e.props.onFetchData())}).catch(function(t){})}},{key:"anonymousFunc0",value:function(t){}},{key:"anonymousFunc1",value:function(t){}},{key:"anonymousFunc2",value:function(t){}},{key:"anonymousFunc3",value:function(t,e){return this.anonymousFunc3Map[t]&&this.anonymousFunc3Map[t](e)}},{key:"anonymousFunc4",value:function(t,e){return this.anonymousFunc4Map[t]&&this.anonymousFunc4Map[t](e)}}]),o}(),_class.$$events=["viewActivety","anonymousFunc0","anonymousFunc1","anonymousFunc2","anonymousFunc3","anonymousFunc4"],_class.options={addGlobalClass:!0},_class.multipleSlots=!0,_class.$$componentPath="pages/hackOrder-t/components/barginTargetNew/index",_temp2);exports.default=BargainTargetNew,Component(require("../../../../npm/@tarojs/taro-weapp/index.js").default.createComponent(BargainTargetNew));