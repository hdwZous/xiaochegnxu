"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _class,_temp2,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}}(),_get=function t(e,n,o){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,n);if(void 0!==a){if("value"in a)return a.value;a=a.get;return void 0!==a?a.call(o):void 0}e=Object.getPrototypeOf(e);if(null!==e)return t(e,n,o)},_index=require("../../npm/@tarojs/taro-weapp/index.js"),_index2=_interopRequireDefault(_index),_indexWeapp=require("../../npm/@jd/djmp/common-t/js/env/index.weapp.js"),_indexWeapp2=require("../../npm/@jd/djmp/common-t/js/storage/index.weapp.js"),_indexModuleScssMap=require("./index.module.scss.map.js"),_indexModuleScssMap2=_interopRequireDefault(_indexModuleScssMap),_index3=require("./api/index.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _asyncToGenerator(t){return function(){var r=t.apply(this,arguments);return new Promise(function(i,s){return function e(t,n){try{var o=r[t](n),a=o.value}catch(t){return void s(t)}if(!o.done)return Promise.resolve(a).then(function(t){e("next",t)},function(t){e("throw",t)});i(a)}("next")})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var isInWeappH5=(0,_indexWeapp.getH5InWeappFlag)(),isH5=!1,isWeapp=!0,location={},Index=(_temp2=_class=function(){function i(){var t,e;_classCallCheck(this,i);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=e=_possibleConstructorReturn(this,(t=i.__proto__||Object.getPrototypeOf(i)).call.apply(t,[this].concat(o)))).$usedState=["loopArray35","loopArray36","$compid__219","style","mockOpen","selectId","data","selectApiList","mockDataList","scrollLeft","isDialogShow","apiMockList"],e.config={navigationBarTitleText:"mock工具",navigationBarBackgroundColor:"#fff",navigationBarTextStyle:"black",onReachBottomDistance:160,navigationStyle:"custom"},e.anonymousFunc2Map={},e.anonymousFunc3Map={},e.customComponents=["MockDialog"],_possibleConstructorReturn(e,t)}var t,e;return _inherits(i,_index.Component),_createClass(i,[{key:"_constructor",value:function(t){_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"_constructor",this).call(this,t),this.goToLoginParams={localTargetUrl:"/pages/mockTools/index"},this._mockData="object"==_typeof((0,_indexWeapp2.getStorageSync)("mockData"))?(0,_indexWeapp2.getStorageSync)("mockData"):"string"==typeof(0,_indexWeapp2.getStorageSync)("mockData")&&(0,_indexWeapp2.getStorageSync)("mockData")?JSON.parse((0,_indexWeapp2.getStorageSync)("mockData")):{},this.state={data:[],scrollLeft:0,selectId:0,selectApiList:[],mockOpen:this._mockData.isMock||!1,mockDataList:[],isDialogShow:!1,apiMockList:this._mockData.functionList||[]};t=this.$router.params.appVersion;this.appVersion=t||"",this.mockData={isMock:this.state.mockOpen,path:this._mockData.path||"http://192.168.82.201:3000/mock/28",functionList:this._mockData.functionList||[]},console.log("zoulianfa =====",(0,_indexWeapp2.getStorageSync)("mockData"),this.state,_typeof((0,_indexWeapp2.getStorageSync)("mockData"))),this.$$refs=[]}},{key:"componentWillMount",value:(e=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this,_index2.default.getSystemInfo({success:function(t){e.setState({statusBarH:t.statusBarHeight}),"ios"!=t.platform&&"android"==t.platform?e.setState({toBar:48}):e.setState({toBar:44})}}),(0,_index.getApp)().globalData.pageStack.push("newPersonB");case 4:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)})},{key:"componentDidShow",value:(t=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(e=this.$router.params).userAction&&(this.userAction=decodeURIComponent(e.userAction)),this._initPage(),e.business&&((0,_index.getApp)().globalData.qrcode.business=e.business||null,(0,_index.getApp)().globalData.qrcode.roomid=e.roomId||null);case 4:case"end":return t.stop()}},t,this)})),function(){return t.apply(this,arguments)})},{key:"_initPage",value:function(){var i=this;console.log("enter _initPage",this.state),(0,_index3.mockLogin)({email:"zoulianfa@imdada.cn",password:"zoulianfa@imdada.cn"}).then(function(t){for(var e=[],e=t.resp.header["Set-Cookie"].replace(/,/g,";").split(";"),n="",o=0;o<e.length;o++){var a=e[o].split("=");"_yapi_token"!=a[0]&&"_yapi_uid"!=a[0]||(n=n?n+";"+e[o]:n+e[o]),(0,_indexWeapp2.setStorageSync)("_yapi",n)}console.log("zoulianfa, mockLogin",e),(0,_index3.mockListMenu)({project_id:28,limit:0}).then(function(t){var e=t.result,t=t.resp;console.log("zoulianfa, mockListMenu",t),i.setState({data:e.data,selectId:e.data[0]._id,selectApiList:e.data[0].list||[]})})}).catch(function(){console.log("login catch")})}},{key:"mockDatas",value:function(t){var n=this;(0,_index3.mockDataCase)({interface_id:t._id}).then(function(t){var e=t.result,t=t.resp;console.log("zoulianfa mockDataCase",t),n.setState({mockDataList:e.data,isDialogShow:!0})})}},{key:"handleMockDataChoice",value:function(e){var n=this.state.selectApiList.find(function(t){return t._id===e.interface_id}),t=this.mockData.functionList.findIndex(function(t){return t.functionId===n.path});-1!==t?this.mockData.functionList[t].params=e.params:this.mockData.functionList.push({functionId:n.path,params:e.params}),this.setState({isDialogShow:!1,apiMockList:this.mockData.functionList}),(0,_indexWeapp2.setStorageSync)("mockData",this.mockData)}},{key:"handleMockDataCancel",value:function(){this.setState({isDialogShow:!1})}},{key:"apiClose",value:function(){(0,_indexWeapp2.removeStorageSync)("mockData"),this.setState({apiMockList:[],mockOpen:!1}),this.mockData.isMock=!1,this.mockData.path="http://192.168.82.201:3000/mock/28",this.mockData.functionList=[]}},{key:"onGoBack",value:function(){_index2.default.navigateBack({delta:0<arguments.length&&void 0!==arguments[0]?arguments[0]:1})}},{key:"mockOpenChange",value:function(t){this.setState({mockOpen:t}),this.mockData.isMock=t,(0,_indexWeapp2.setStorageSync)("mockData",this.mockData)}},{key:"_createData",value:function(){var a=this;this.__state=arguments[0]||this.state||{},this.__props=arguments[1]||this.props||{};var t=this.$prefix,e=(0,_index.genCompid)(t+"$compid__219"),n=this.__state,o=n.data,i=n.selectApiList,s=(n.selectId,n.mockOpen,n.mockDataList),r=n.isDialogShow,c=n.apiMockList;this.anonymousFunc4=function(){a.onGoBack()},this.anonymousFunc0=function(t){a.mockOpenChange(t.detail.value)},this.anonymousFunc1=function(){a.apiClose()};t=o&&0<o.length?o.map(function(t,e){t={$original:(0,_index.internal_get_original)(t)};var n="fHpry"+e;return a.anonymousFunc2Map[n]=function(){a.setState({selectId:t.$original._id||0,selectApiList:t.$original.list||[]})},{_$indexKey:n,$loopState__temp3:o&&0<o.length?"key"+e:null,$original:t.$original}}):[],n=i&&0<i.length?i.map(function(e,t){e={$original:(0,_index.internal_get_original)(e)};var n=c.findIndex(function(t){return t.functionId===e.$original.path}),o="HudRP"+t;return a.anonymousFunc3Map[o]=function(){a.mockDatas(e.$original)},{_key:n,_$indexKey2:o,$loopState__temp5:i&&0<i.length?"index"+t:null,$original:e.$original}}):[];return s&&0<s.length&&_index.propsManager.set({dialogInfo:s,isDialogShow:r,apiMockList:c,handleMockDataCancel:this.handleMockDataCancel.bind(this),handleMockDataChoice:this.handleMockDataChoice.bind(this)},e),Object.assign(this.__state,{loopArray35:t,loopArray36:n,$compid__219:e,style:_indexModuleScssMap2.default}),this.__state}},{key:"anonymousFunc0",value:function(t){}},{key:"anonymousFunc1",value:function(t){}},{key:"anonymousFunc2",value:function(t,e){return this.anonymousFunc2Map[t]&&this.anonymousFunc2Map[t](e)}},{key:"anonymousFunc3",value:function(t,e){return this.anonymousFunc3Map[t]&&this.anonymousFunc3Map[t](e)}},{key:"anonymousFunc4",value:function(t){}}]),i}(),_class.$$events=["anonymousFunc4","anonymousFunc0","anonymousFunc1","anonymousFunc2","anonymousFunc3"],_class.$$componentPath="pages/mockTools/index",_temp2);exports.default=Index,Component(require("../../npm/@tarojs/taro-weapp/index.js").default.createComponent(Index,!0));