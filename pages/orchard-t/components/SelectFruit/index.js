"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _class,_temp2,_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,i=arguments[t];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},_createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),_get=function e(t,n,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);return void 0!==o?"value"in o?o.value:void 0!==(o=o.get)?o.call(i):void 0:null!==(o=Object.getPrototypeOf(t))?e(o,n,i):void 0},_index=require("../../npm/@tarojs/taro-weapp/index.js"),_index2=_interopRequireDefault(_index),_indexWeapp=require("../../npm/@jd/djmp/common-t/js/taroapi/index.weapp.js"),_indexWeapp2=require("../../npm/@jd/djmp/common-t/js/bi/index.weapp.js"),_orchard=require("../../api/orchard.js"),_utils=require("../../js/utils.js"),_indexModuleScssMap=require("./index.module.scss.map.js"),_indexModuleScssMap2=_interopRequireDefault(_indexModuleScssMap);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var nickResult=[{nickName:"顶起顶替锯中圆顶jflk顶起",exchangeTime:"2021-08-12 00:00:00",userIcon:"https://img11.360buyimg.com/promotiongame/jfs/t1/159509/4/20868/35130/607f923fE9da79bb6/69277783126e41c8.jpg",timeInterval:"20分钟",fruitName:"一颗桔林人子"},{nickName:"苹村果",exchangeTime:"2021-08-12 00:00:00",userIcon:"https://img11.360buyimg.com/promotiongame/jfs/t1/159509/4/20868/35130/607f923fE9da79bb6/69277783126e41c8.jpg",timeInterval:"20分钟",fruitName:"一颗苹果"},{nickName:"天天在",exchangeTime:"2021-08-12 00:00:00",userIcon:"https://img11.360buyimg.com/promotiongame/jfs/t1/159509/4/20868/35130/607f923fE9da79bb6/69277783126e41c8.jpg",timeInterval:"20分钟",fruitName:"一颗林"},{nickName:"中没有文",exchangeTime:"2021-08-12 00:00:00",userIcon:"https://img11.360buyimg.com/promotiongame/jfs/t1/159509/4/20868/35130/607f923fE9da79bb6/69277783126e41c8.jpg",timeInterval:"50分钟",fruitName:"一颗苹果"}],REPORT={clickConfirmChange:function(e){(0,_indexWeapp2.clickReport)({click_id:"clickConfirmChange",click_par:{fruitName:e}})},clickWaitChange:function(e){(0,_indexWeapp2.clickReport)({click_id:"clickWaitChange",click_par:{fruitName:e}})}},SelectFruit=(_temp2=_class=function(){function r(){var e,t;_classCallCheck(this,r);for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t=_possibleConstructorReturn(this,(t=r.__proto__||Object.getPrototypeOf(r)).call.apply(t,[this].concat(i)))).$usedState=["anonymousState__temp","loopArray6","loopArray7","$compid__20","style","activeIndex","SelectFruitData","isReselectFlag","fruitNameBefore","showSelectFruitFlag","showMain","nickResult","showConfirm","fruitId","fruitName","hideSelectFruit","refreshNewPersonFunc","finishReselet","commitByFinishChoose","activityId","isLargeScreen"],t.anonymousFunc0Map={},t.anonymousFunc1Map={},t.customComponents=["BarrageMoveView"],_possibleConstructorReturn(t,e)}return _inherits(r,_index.Component),_createClass(r,[{key:"_constructor",value:function(e){var t=this;_get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"_constructor",this).call(this,e),this.state={showMain:!0,showConfirm:!1,activeIndex:0,fruitId:"",fruitName:"",nickResult:[]},this.$$refs=[{type:"component",id:"zNSBb",refName:"",fn:function(e){return t.childBarrageMove=e}}]}},{key:"handleClose",value:function(){this.props.hideSelectFruit&&this.props.hideSelectFruit()}},{key:"refreshNewPersonFunc",value:function(){this.props.refreshNewPersonFunc&&this.props.refreshNewPersonFunc()}},{key:"handleCancleForRe",value:function(){this.handleCancle();var e=this.state.fruitName;REPORT.clickWaitChange(e)}},{key:"handleCancle",value:function(){this.props.finishReselet&&this.props.finishReselet()}},{key:"commitByFinishChoose",value:function(e){this.props.commitByFinishChoose&&this.props.commitByFinishChoose(e)}},{key:"handleChooseForRe",value:function(){this.handleChoose();var e=this.state.fruitName;REPORT.clickConfirmChange(e)}},{key:"handleChoose",value:function(){var t=this,e=this.props,n=e.SelectFruitData,e=e.activityId,i=_extends({fruitId:this.state.fruitId||n[0].fruitId,fruitName:this.state.fruitName||n[0].name},(0,_utils.setParamsInGetInitData)(),{activityId:e});(0,_orchard.confirmFruitBeginActivityInfo)(i).then(function(e){"0"==e.code||0==e.code?(t.setState({showConfirm:!1}),t.handleClose(),setTimeout(function(){t.refreshNewPersonFunc()},10),(0,_indexWeapp2.clickReport)({create_time:new Date,click_id:"chooseFruitFTE",click_par:{fruitName:i.fruitName}}),t.commitByFinishChoose(e.result),t.handleCancle()):(0,_indexWeapp.showToast)({title:res.msg})}).catch(function(e){(0,_indexWeapp.showToast)({title:e.msg||"网络开小差，请稍后重试"})})}},{key:"handleClickFruit",value:function(e,t){this.setState({activeIndex:e,fruitId:t.fruitId,fruitName:t.name})}},{key:"cancle",value:function(){this.setState({showMain:!0,showConfirm:!1})}},{key:"sure",value:function(){this.handleClose()}},{key:"getRecords",value:function(){var t=this;(0,_orchard.getUserExchangeRecordsFn)().then(function(e){console.log("testss",e),"0"!=e.code&&0!=e.code||t.setState({nickResult:e.result})}).catch(function(e){})}},{key:"refreshBarrage",value:function(){this.childBarrageMove&&this.childBarrageMove.refrshBarrageTime()}},{key:"componentWillReceiveProps",value:function(e){}},{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"_createData",value:function(){var r=this,e=(this.__state=arguments[0]||this.state||{},this.__props=arguments[1]||this.props||{},this.$prefix),e=(0,_index.genCompid)(e+"$compid__20"),t=this.__state,n=t.showMain,t=(t.showConfirm,t.activeIndex,t.nickResult),i=this.__props,o=i.showSelectFruitFlag,a=i.SelectFruitData,s=i.isReselectFlag,c=i.fruitNameBefore,i=i.isLargeScreen,i=void 0!==i&&i,i=(console.log(i,"isLargeScreen"),(0,_index.internal_inline_style)({transform:i?"translate(-50%,-50%) scale(0.75)":""})),u=a?a.map(function(e,t){e={$original:(0,_index.internal_get_original)(e)};var n="iAcmz"+t;return r.anonymousFunc0Map[n]=function(){r.handleClickFruit(t,e.$original)},{_$indexKey:n,$original:e.$original}}):[],l=a?a.map(function(e,t){var n=(e={$original:(0,_index.internal_get_original)(e)}).$original,i=n.pic,n=n.name,o="PdPCh"+t;return r.anonymousFunc1Map[o]=function(){r.handleClickFruit(t,e.$original)},{pic:i,name:n,_$indexKey2:o,$original:e.$original}}):[];return o&&!s&&n&&t&&0<t.length&&_index.propsManager.set({newMessages:t,numberOfLines:2,speed:5},e),Object.assign(this.__state,{anonymousState__temp:i,loopArray6:u,loopArray7:l,$compid__20:e,style:_indexModuleScssMap2.default,SelectFruitData:a,isReselectFlag:s,fruitNameBefore:c,showSelectFruitFlag:o}),this.__state}},{key:"anonymousFunc0",value:function(e,t){return this.anonymousFunc0Map[e]&&this.anonymousFunc0Map[e](t)}},{key:"anonymousFunc1",value:function(e,t){return this.anonymousFunc1Map[e]&&this.anonymousFunc1Map[e](t)}}]),r}(),_class.$$events=["cancle","sure","anonymousFunc0","handleChoose","anonymousFunc1","handleChooseForRe","handleCancle"],_class.$$componentPath="pages/orchard-t/components/SelectFruit/index",_temp2);exports.default=SelectFruit,Component(require("../../npm/@tarojs/taro-weapp/index.js").default.createComponent(SelectFruit));