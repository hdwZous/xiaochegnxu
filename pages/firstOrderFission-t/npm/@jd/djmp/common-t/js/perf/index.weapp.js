"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t,a=arguments[r];for(t in a)Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t])}return e},_createClass=function(){function a(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,r,t){return r&&a(e.prototype,r),t&&a(e,t),e}}(),_indexWeapp=require("../bi/index.weapp.js");function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var perfArr={},getPageName=function(){var e=getCurrentPages();return(e[e.length-1]||{}).route||"unknown"},Perf=function(){function a(){_classCallCheck(this,a),this.data={startTime:Date.now(),endTime:0,component_totalTime:0},this.extTime={},this.pageName=getPageName(),this.reported=!1}return _createClass(a,[{key:"start",value:function(){var e=getPageName();perfArr[e].data.startTime=Date.now()}},{key:"add",value:function(e,r){var t=getPageName(),t=perfArr[t];return t.extTime[e]=r,t}},{key:"end",value:function(){var e=getPageName(),e=perfArr[e];e.data.endTime=Date.now(),e.data.component_totalTime=e.data.endTime-e.data.startTime,this.report()}},{key:"destroy",value:function(){var e=getPageName();perfArr[e]=null}},{key:"report",value:function(){var e=getPageName(),e=perfArr[e];1!=e.reported&&(e.reported=!0,console.log("开始上报页面",e.pageName),console.log("开始上报",e.data,e.extTime),(0,_indexWeapp.clickReport)({click_id:"performance_dev",click_par:_extends({},e.data,e.extTime)}))}}],[{key:"getInstance",value:function(e){var r=getPageName(),t=perfArr[r];return t&&t.pageName!==r&&(perfArr[r]=new a(e)),t||(perfArr[r]=new a(e)),perfArr[r]}}]),a}();exports.default=Perf;