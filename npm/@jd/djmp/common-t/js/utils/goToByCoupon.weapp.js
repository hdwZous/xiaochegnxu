"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(o){for(var e=1;e<arguments.length;e++){var n,t=arguments[e];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n])}return o},_index=(exports.goToByCouponId=goToByCouponId,exports.goToByCouponIdOpenApp=goToByCouponIdOpenApp,exports.jumpCase=jumpCase,exports.jumpCaseOpenAPP=jumpCaseOpenAPP,require("../../../../../@tarojs/taro-weapp/index.js")),_index2=_interopRequireDefault(_index),_indexWeapp=require("../http/index.weapp.js"),_indexWeapp2=require("../taroapi/index.weapp.js");function _interopRequireDefault(o){return o&&o.__esModule?o:{default:o}}var singleCouponTreadyFun=function(){return(0,_indexWeapp.request)({functionId:"coupon/singleCouponTready",body:JSON.stringify(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),method:"GET"})};function goToByCouponId(e){var o=e.couponId,n=e.code,t=e.passThroughParam;singleCouponTreadyFun({couponGoSource:1<arguments.length&&void 0!==arguments[1]?arguments[1]:3,couponId:o,passThroughParam:t=!t&&n?{code:n}:t}).then(function(o){0==o.code?jumpCase(_extends({},o.result,e)):wx.showToast({title:o.msg||"网络开小差，请稍后重试",icon:"none",duration:1500})}).catch(function(o){wx.showToast({title:o.msg||"网络开小差，请稍后重试",icon:"none",duration:1500})})}function goToByCouponIdOpenApp(e){var o=e.couponId;singleCouponTreadyFun({couponGoSource:1<arguments.length&&void 0!==arguments[1]?arguments[1]:3,couponId:o}).then(function(o){0==o.code?jumpCaseOpenAPP(_extends({},o.result,e)):wx.showToast({title:o.msg||"网络开小差，请稍后重试",icon:"none",duration:1500})}).catch(function(o){wx.showToast({title:o.msg||"网络开小差，请稍后重试",icon:"none",duration:1500})})}function parseParams(o){o.params=_extends({},o.params,o.params.passThroughParam);var e,n,t="",i=(o.userAction&&(t=encodeURIComponent(o.userAction)),"");for(e in o.params)"isAddCart"==e&&(n=o.params[e]+"",o.params[e]="true"==n||""),i+="&"+e+"="+(o.params[e]||"");return i="{}"==JSON.stringify(o.params)?"?userAction="+t:"?"+i.slice(1)+"&userAction="+t}function jumpCase(o){var e,n=o.to,t=o.longitude,t=void 0===t?"":t,i=o.latitude,i=void 0===i?"":i,a=o.cityId,a=void 0===a?"":a,p=o._homeToStoreList,p=void 0!==p&&p,d=o.params,d=void 0===d?{}:d,s=(o.code,d||{}),r=s.limitId,r=void 0===r?"":r,u=s.storeId,u=void 0===u?"":u,c=s.orgCode,c=void 0===c?"":c,m=s.jumpType,s=s.skuId,s=void 0===s?"":s;n?(e="","storeList"===n?(0,_indexWeapp2.navigateTo)(e="/pages/purchTicket/purchTicketsStoreList/storeList?promotionInfoId="+r+"&jumpType="+(void 0===m?"":m)+"&longitude="+t+"&latitude="+i+"&cityId="+a):"goodsList"===n?(0,_indexWeapp2.navigateTo)(e="/pages/purchTicket/purchTickets/purchTickets?stationNo="+u+"&couponId="+r+"&longitude="+t+"&latitude="+i+"&orgCode="+c):"store"===n?(0,_indexWeapp2.navigateTo)(e="/pages/store/index?storeId="+(u||"")+"&orgCode="+(c||"")+"&skuId="+(s||"")+"&couponId="+(r||"")+"&longitude="+(t||"")+"&latitude="+(i||"")+"cityId="+(a||"")):"home"===n?p?(0,_indexWeapp2.navigateTo)("/pages/nearbyStore/index"):(0,_indexWeapp2.switchTab)("/pages/home/home"):"couponGoodsList"===n&&d&&d.passThroughParam&&d.passThroughParam.code?(e="/pages/purchTicket/couponGo/index"+parseParams(o),(0,_indexWeapp2.navigateTo)(e)):(0,_indexWeapp2.switchTab)("/pages/home/home")):"home"==o.defaultJump_?(0,_indexWeapp2.switchTab)("/pages/home/home"):wx.showToast({icon:"none",title:"附近没有门店耶~换个地方再试试",duration:2e3})}function jumpCaseOpenAPP(o){var e=o.to,n=(o.longitude,o.latitude,o.cityId,o._homeToStoreList,o.params),t=o.second,i=o.popup,a=o.channel,n=(void 0===n?{}:n)||{},p=n.limitId,p=void 0===p?"":p,d=n.storeId,d=void 0===d?"":d,s=n.orgCode,s=void 0===s?"":s,r=n.jumpType,r=void 0===r?"":r,n=n.skuId,n=void 0===n?"":n;e?"home"===e?window.location.href="openApp.jddj://communication?body="+encodeURIComponent(JSON.stringify({params:{},to:"home"})):"storeList"===e||"goodsList"==e?window.location.href="openApp.jddj://communication?body="+encodeURIComponent(JSON.stringify({params:{limitId:p,jumpType:r||"goodsList"},to:"storeList"})):"store"===e&&(window.location.href="openApp.jddj://communication?body="+encodeURIComponent(JSON.stringify({to:"store",params:{storeId:d||"",skuId:n||"",orgCode:s||"",needAnchorSku:!0,addCart:!0,isAddCart:!0,needAddCar:!0,second:t||"",popup:i||"",channel:a||""}}))):"home"==o.defaultJump_?window.location.href="openApp.jddj://communication?body="+encodeURIComponent(JSON.stringify({params:{},to:"home"})):wx.showToast({icon:"none",title:"附近没有门店耶~换个地方再试试",duration:2e3})}